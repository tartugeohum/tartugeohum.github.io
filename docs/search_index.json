[["index.html", "HVEE.00.045 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes Praktikum 1 Sissejuhatus 1.1 Kursuse korraldusest 1.2 Mis on geoinfosüsteemid? 1.3 Geoinfosüsteemide ajaloost 1.4 Ruumiandmed ja GIS humanitaarteadustes 1.5 Ruumiobjektid ja ruumiandmed", " HVEE.00.045 Geoinfosüsteemide rakendusvõimalused humanitaarteadustes Maarja-Liisa Pilvik sügis 2025 Praktikum 1 Sissejuhatus 1.1 Kursuse korraldusest 3 EAP K kell 12.15-13.45 Lossi 3-425 Kontakt ja info: maarja-liisa.pilvik@ut.ee Hindamine arvestuslik. Kursuse lõpuks peavad olema esitatud vabal valikul 2 kodutööd 3st. Esitamiseks aega kursuse lõpuni; lõpuprojekt. Esitlused 10. ja 17. detsembril. Lõpuprojekti esitamise tähtaeg 7.detsember kell 23.59. Soovijatele konsultatsioonid kokku lepitud aegadel. Kodutööde teemad: story map’i (kaardiloo) tegemine, kaardi georefereerimine, andmestike ühendamine ja visualiseerimine. Arvestuse saamiseks tuleb võtta osa vähemalt 70% auditoorselt toimuvatest praktikumidest, st kohapeal tuleb osaleda vähemalt 10 kohtumisel 14st. Vajadusel on võimalikud erikokkulepped. Tänase praktikumi eest läheb kohalkäimine kõikidele automaatselt kirja. Materjale hoitakse ja täiendatakse kursuse kodulehel ja Moodle’is. 1.2 Mis on geoinfosüsteemid? Geoinfosüsteem on arvutipõhine süsteem ruumiliste ja mitteruumiliste andmete kogumiseks, haldamiseks, analüüsiks, visualiseerimiseks ja jagamiseks. Selle abil on võimalik ruumisuhete kaudu mõista oma andmeid paremini või teisest vaatepunktist ning sedakaudu teha kaalutletumaid otsuseid. Andmete kogumine: nt paberkaartide digiteerimine, päringud repositooriumidest, käsitsi sisestamine; haldamine: nt andmebaaside struktureerimine, dokumenteerimine; analüüs: nt erinevate andmekihtide ühendamine, kattuvate alade, puuduvate väärtuste, puhveralade, teekondade arvutamine; visualiseerimine: nt kaartide koostamine ja kujundamine; jagamine: nt projektide majutamine veebis, andmete ja metaandmete publitseerimine. Joonis 1.1: Mida GISiga tehakse? (Wallentin et al. 2015) Joonis 1.2: Sõnapilv Wikipedia artiklist ‘Geographic information system’ Ehkki vahel käsitletakse geoinfosüsteeme kui mingit kindlat tarkvara (nt ArcGIS, QGIS), on GIS definitsioonilt pigem mingite funktsionaalsuste kogum. See tähendab ka seda, et erinevad tarkvarad või selle osad võivad spetsialiseeruda erinevatele GISi funktsioonidele. Joonis 1.3: Populaarsed GIS tarkvarad Kuigi GIS võib talletada ka mitteruumilist infot, moodustavad kõige olemuslikuma osa geoinfosüsteemidest siiski just ruumiandmed. Kõige sagedamini kasutatakse GISi geograafiliste andmete töötlemiseks, ent neid saab põhimõtteliselt kasutada mis tahes andmete jaoks, millel on mingid dimensioonid (nt väljamõeldud kohad; inimkeha; planeetide pinnad; puuviljad jne). Geoinfosüsteemidest võib seega kõige lihtsamal moel mõelda kui koordinaatidega varustatud andmebaasidest ja nende sisu analüüsimiseks ja visualiseerimiseks mõeldud tööriistadest. Tüüpiliselt toimub andmete analüüs GISis kihtide põhimõttel: eri tüüpi infot hoitakse erinevatel andmekihtidel ning nende ühendamisel sünteesitakse uut teadmist. Joonis 1.4: Andmete hoidmine GISis kihtidena, GIS NatGeo Nagu öeldud, võivad GIS-andmebaasid sisaldada nii ruumilist kui ka mitteruumilist infot. Ruumilist infot väljendatakse koordinaatidega (nt x, y, z, pikkus- ja laiuskraad, kõrgus merepinnast) ning need määravad iga objekti asukoha, kasutades kas punkti, joont, polügooni või pikslit. Mitteruumilist infot, mis mingit kohaga seotud on, väljendavad atribuudid. Atribuudid on tüüpiliselt salvestatud tabelina, kus iga objekt on eraldi real ning iga atribuut eraldi tulbas, või mingis muus (nt hierarhilises) andmebaasistruktuuris. Joonis 1.5: Näide QGISi atribuuttabelist Infotehnoloogia arenguga on muutunud võimalikuks säilitada digitaalsel kujul atribuutidena peaaegu mis tahes tüüpi andmeid, nt struktureerimata tekste (raamatuid, veebilehti), pilte, videoid, helifaile. Kuna geoinfosüsteemid on arvutipõhised, nõuavad need siiski, et andmed oleksid mingil moel formaliseeritud. See tähendab ka vahel seda, et tuleb andmetele suruda peale jäigad kategooriad ka seal, kus kategooriatevahelised piirid on tegelikult sujuvad ning on palju üleminekualasid. 1.3 Geoinfosüsteemide ajaloost Joonis 1.6: John Snow koolera leviku kaart (1855) (Wikimedia Commons) Joonis 1.7: GISi ajajoon Geoinfosüsteeme hakati arendama ja kasutama 1960ndatel, kui akadeemilistes ringkondades hakati uurima kvantitatiivse ja arvutusliku geograafia võimalusi. GISi “isaks” peetakse Roger Tomlinsoni (1933-2014), kes 60ndate alguses arendas Kanadas välja kõige esimese geoinfosüsteemi maailmas (Canada Geographical Information System CGIS). Süsteemi ülesandeks oli talletada, võrrelda ja analüüsida Kanada maakasutuse andmeid. GISi ulatuslikum areng toimus 1970ndatel ning 1980ndate lõpuks oli fookus juba sellel, kuidas parandada GISi kasutuskogemust. Esimestel aastakümnetel oli GIS põhiliselt haldus- ja militaarkasutuses. 1982. aastal tõi ESRI (Environmental Systems Research Institute, Inc.) välja esimese kommertsliku GIS-toote, ARC/INFO, mis põhines Harvard Laboratory Computer Graphicsi poolt arendatud esimesel vektoritega töötaval GISil. ESRI roll GIS-tarkvara arendajana on sellest alates ainult kasvanud. 1990ndatest alates hakkas GISi kasutajaskond kiiresti kasvama. Seda soodustas järjest väiksemate, odavamate ja kiiremate arvutite tootmine, andmete ulatuslikum kättesaadavus ning uute satelliitide ja kaugseiretehnoloogia kasutuselevõtt. Viimast kaht kümnendit on iseloomustanud lisaks tehnoloogia jätkuvale arengule ka vabavaralise GIS-tarkvara teke, mis on teinud ruumiandmete kasutamise ja analüüsi kättesaadavamaks nii tavakasutajale kui ka talle pakutavate toodete arendajatele. On toimunud nn ruumiline revolutsioon (Geospatial Revolution), mis on muutnud nii seda, kuidas me liigume, otsuseid teeme ja oma lugusid jagame. Praeguseks kasutatakse geoinfosüsteeme näiteks telekommunikatsioonis, linnaplaneerimises (näiteks Tallinna Ligipääsetavuse infosüsteem), logistikas, navigeerimises (näiteks Veeteede Ameti Nutimer), meteoroloogias, katastroofide ohjamisel ja leevendamisel, tervishoius, kuritegevuse analüüsil, … Vt veel rakendusvaldkondi nt siit. 1.4 Ruumiandmed ja GIS humanitaarteadustes Ehkki näiteks arheoloogias on ruum ja ruumiandmed olnud alati kesksel kohal, on teistes humanitaaria valdkondades (nt ajaloos, kirjandusteadustes) toimunud viimase paarikümne aasta jooksul nn ruumiline pööre (Spatial Turn). Ruumiline pööre algas tegelikult geograafia valdkonna seest: pelga inimelu või -tegevuse mahuti või “lava” tõlgenduse asemel seati fookusesse ruum kui pidevalt muutuv ja kompleksne sotsiaalne moodustis. See võimaldas leida enam ühist keelt ka sotsiaal- ja humanitaarteadlastega. Humanitaarteadustes on küll ruumi ja koha mõistetel olnud alati üsna prominentne roll, ent ruumilise pöörde käigus seati fookus eksplitsiitselt sellele, kuidas sotsiaalsete muutuste ning laiemalt inimtegevuse seletamiseks tuleb võtta arvesse ka ruumilist komponenti. Sealjuures rõhutatakse, et ruum võib ajas muutuda ning et ruumid võivad olla nii füüsilis-geograafilised kui ka abstraktsed, metafoorsed või väljamõeldud (vt nt Keele &amp; Kirjanduse erinumbrit “Keel ja ruum”). Nõnda on näiteks keskaegses kirjanduses narratiivi loomise seisukohast võrdselt olulised nii London kui ka Camelot; erinevate keelte kohaväljendeid (nt kaassõnu ees, kõrval, taga) uurides saame teada, kuidas mingi keele kõneleja end mõtteliselt millegi suhtes positsioneerib (kas absoluutselt või relatiivselt), kuidas tajutakse aega ruumisuhete kaudu jne. Ruumi asetamine kesksele positsioonile on digihumanitaaria katusmõiste alla sünnitanud interdistsiplinaarsed valdkonnad nimega geohumanitaaria (GeoHumanities) ja ruumihumanitaaria (Spatial Humanities), mis ühendavad GISi ja klassikalised ruumianalüüsi meetodid (nt teekondade arvutamine, kaartide koostamine) uuemate arvutuslike meetoditega (nt loomuliku keele töötlus, võrgustikuanalüüs, simulatsioonimudelid, tehisnärvivõrgud). Ruumihumanitaaria ja geohumanitaaria vaheline piir ei ole päris selge ning sageli kasutatakse mõisteid sünonüümidena, samuti on mõlemal valdkonnal suur ühisosa inimgeograafiaga. Kui aga eristust tehakse, siis loetakse geohumanitaaria valdkonda pigem konkreetsete, geograafiliste kohtade ja ruumidega tegelevad uurimused ning ruumihumanitaaria alla ka uurimused, mis analüüsivad sümboolseid, ähmaseid või väljamõeldud ruume. Ehkki mingites humanitaaria valdkondades (nt arheoloogia) on ka geoinfosüsteemid olnud kasutusel juba aastakümneid, on nende võimalusi hakatud teistes humanitaarteaduste harudes rohkem kasutama alles viimase kümne-viieteistkümne aasta jooksul. See on ühelt poolt seotud arvutite võimsuse ning tarkvara ja andmete kättesaadavuse plahvatusliku kasvuga, ent ka teatava suhtumise muutusega humanitaaride seas. Ehkki humanitaaria uurimisobjektid ja andmed on sageli ebatäpsed, hägusad, täpselt määramatud ja fragmentaarsed ning nende analüüs GISi abil pakub endiselt rohkelt väljakutseid, ei nähta tehnoloogias kõigest positivistlikku ja humanitaaraladele olemuslikult sobimatut analüüsivahendit. GISi väärtus humanitaarteadustele seisneb eeskätt selles, et kohainfo (nt kohanime või koordinaatide) kaudu on võimalik ühendada eri formaatides väga erinevat infot, seda visualiseerida ning erinevatest infokihtidest sünteesida uut teadmist. Sealjuures on nõuded absoluutsele täpsusele humanitaarias oluliselt leebemad. Joonis 1.8: Andrus Saareste käsikirjaline murdekaart sõna ‘keegi’ alaleütleva käände (‘kellelegi’, ‘kellegile’ jm) varieerumisest. Geo- ja ruumihumanitaaria fookus ei ole aga pelgalt tehniliste analüüsimeetodite ja tööriistade kasutamisel ja arendamisel, vaid ka (või isegi eelkõige) ruumide ja kohtade teoreetilistel konstruktsioonidel ning nende muutumisel ajas ning eri kultuurides: kuidas mingites ruumides elatakse, kuidas mingeid ruume sotsiaalselt konstrueeritakse ja kuidas need ruumid omakorda mõjutavad majandust, poliitikat, kultuuri jne. Siiski on vahest enamgi neid, kes ühel või teisel moel ruumiandmeid ja geoinfosüsteeme oma töös ära kasutavad, ilma et ennast või oma uurimistööd spetsiifiliselt ruumi- või geohumanitaaria valdkonna kaudu defineeriksid. Sellise üldise ruumiandmete analüüsi tööriistakasti koostamisega tegeleme ka siin kursusel. 1.4.1 Lugude jutustamine 1.4.2 Arheoloogia Joonis 1.9: Muististe jaotumise visualiseerimine ja maastiku nähtavuse analüüsimine (Kimber 2016) Joonis 1.10: Muinasaegsete asulakohtade ennustav mudeldamine (Haav 2014) 1.4.3 Keeleteadus Joonis 1.11: ‘ei ole’/‘pole’ levikuandmed (murdeatlasest) ja ‘pole’ sagedusandmed (murdekorpusest) (Lindström et al. 2019) 1.4.4 Keele-/sotsiaalteadus Joonis 1.12: Keeleline mitmekesisus Helsingi piirkonnas rahvastikuregistri vs. sotsiaalmeeedia postituste andmete põhjal (Väisänen et al. 2022) 1.4.5 Veel näiteid Joonis 1.13: Rongiliikluse areng Prantsusmaal (Gregory et al. 2014) Joonis 1.14: Pariisi tänavate nimetamine kirjanduses (Moncla et al. 2019) Rahvusraamatukogu andmestikud kaartidel (RaRa digilabor) Kultuuripärandi kujutamine kaartidel (RaRa digilabor) Virtuaalne kakskeelne kultuurilooline kaart “Saksa Tartu / Deutsches Dorpat” (Tartu Linnamuuseum). Kaart tutvustab Tartu linna kultuurilugu saksakeelsete linnakirjelduste ja nende tekstide eestikeelsete tõlgete kaudu. Valitud tekstide hulgas on katkendeid mälestustest, ilukirjandusest, reisikirjadest, aga ka mitmeid baltisaksa anekdoote Tartu kohta. Tekstid viivad uitama nii Emajõe äärde kui ka Toomemäele, annavad võimaluse põigata vanadesse kondiitriäridesse, tudengikõrtsidesse, loengusaalidesse ja mujalegi. Ülejõe paigad ja lood (Tartu linnamuuseum). Interaktiivne kaardirakendus, mille sisuks on Ülejõe praeguste ja endiste elanike lood ja mälestused Ülejõe erinevatest asutustest, paikadest, sündmustest ja elu-olust peamiselt Nõukogude okupatsiooni ajal. The Stanford Geospatial Network Model of the Roman World - ORBIS. ORBIS simuleerib liikumist Rooma impeeriumi aegse teedevõrgu peamistel marsruutidel, laevatatavatel jõgedel ja mereteedel Vahemeres, Mustal merel ja Atlandi ookeani rannikul ning rekonstrueerib interaktiivselt antiikaja reisi kestust ja rahalisi kulusid, võimaldades arvesse võtta ka erinevaid transpordiviise ja -vahendeid ning hooajalisi erinevusi. Geocoded art. Rakendus koondab maailma olulisemaid maastiku- ja meremaale ning võimaldab võrrelda kujutatut tegeliku asukohaga. LotrProject koondab erinevaid “Sõrmuste isandaga” seotud projekte, muu hulgas interaktiivseid kaarte ja ajajooni. A Literary Atlas of Europe. Projekt, mille eesmärgiks on uurida, kaardistada ja omavahel võrrelda kolme Euroopa piirkonda kirjandusgeograafilisest vaatenurgast. Loodav andmebaas võimaldab mitmekesist temaatilist ja ruumilist analüüsi. 1.5 Ruumiobjektid ja ruumiandmed Meid ümbritsevas maailmas on palju erinevaid ruumiga seotud nähtusi, näiteks konkreetsed füüsilised objektid (teed, hooned), kokuleppelised või abstraktsed objektid (nt riigipiir), sündmused (nt katastroofid, meeleavaldused, spordiüritused) või ka mingid pidevad nähtused, nagu temperatuur, mis esinevad väljana terves ruumis ning mille konkreetset väärtust on mingites ruumi punktides võimalik määrata. Humanitaarteaduste kontekstis võime mõelda ka sellistest ruumiga seotud nähtustest ja objektidest, nagu migratsioon ja asustus, kirjandusteoste sündmused, (tajutavad) murdepiirid, keelekasutus (sõnad, konstruktsioonid), lahingud, sõjakäigud, uskumused ja usundid jne. Nähtustel on omakorda mingid omadused, mille abil neid nähtusi või ruumi ennast kirjeldada. (Geo)infosüsteemide abil saame reaalse maailma objekte ja nähtusi hallata, kujutada ja analüüsida aga ainult nende mingil moel abstraheeritud ja formaliseeritud kujul, ruumiobjektina. Ruumiandmete seaduse definitsioon (§ 3, lg 3): Ruumiobjekt käesoleva seaduse tähenduses on konkreetse asukoha või geograafilise alaga seotud reaalmaailma nähtuse abstraktne kujutis. Ruumiandmed omakorda kirjeldavad … ruumiobjektide asukohta, omadusi ja kuju geograafilises ruumis. (Ruumiandmete seaduse § 3, lg 1.) Objektidele ja nähtustele sobiva kujutamisviisi valimine sõltub eeskätt sellest, kas läheneme ruumile ja selles asuvatele objektidele ja nähtustele objektikeskselt või asukohakeskselt. Objektikeskses lähenemises seame fookusesse objektid. Need täidavad kindlates punktides mingit ruumi, neid saab loendada, need võivad külgneda ja kattuda, neil on mingid kindlad omadused, need on võib-olla seotud mingite teiste objektidega jne. Ruum ja selle omadused on ainult üks atribuut, mille kaudu objekte kirjeldada. Sellises lähenemises on objektid diskreetsed: neil on kindel asukoht ja ruumikuju (nt hoone, mälestusmärk, riigipiir). Asukohakeskses lähenemises on fookus ruumil. Ruum on sama objektiga otsast otsani täidetud. Objektid ja nende omadused kirjeldavad ruumi, on ruumi atribuutideks. Asukohakeskses lähenemises on objektid pidevad: objekt esineb terves ruumis, aga saab ruumi erinevates punktides erineva väärtuse (nt maapinna reljeef, temperatuur ja õhurõhk maapinnal, kultuurikihi intensiivsus/kontsentratsioon). Need kaks lähenemist on aluseks sellele, kuidas ruumiobjekte geoinfosüsteemis kujutada: kas vektorkujul või rasterkujul. Vastavaid kujutusviise nimetatakse ka ruumiandmete mudeliteks. Joonis 1.15: Vektor- vs. rasterandmed (Bolstad 2016 : 41) 1.5.1 Vektorandmed Vektormudelis kujutatakse andmeobjekte geomeetriliste kujundite abil. Geomeetrilisi põhiobjekte ehk primitiive on 3: punkt (nt torn, kivi), joon (nt tee, jõgi), pind/areaal/polügoon/ala (nt põld, mets, linn). Joonis 1.16: Punktid, jooned, polügoonid (Ballas et al. 2018 : 13) Punkt on eukleidilises mõttes nullmõõtmeline ning seda esitatakse koordinaatsüsteemis kujul P(x; y). Mitmest punktist moodustub ühemõõtmeline joon, enamasti murdjoon, mille (käänu)punktid saab ühendada sirglõiguga. Joonest omakorda saab moodustada polügooni, mispuhul joone algus- ja lõpp-punkt kattuvad. Joonis 1.17: Geomeetrilised objektid (Bolstad 2016 : 43) Geomeetrilise objekti valik sõltub sealjuures sellest, kui täpselt mingit andmeobjekti soovitakse kujutada. Näiteks võib Eesti pühapaikade kaardistamisel kasutada punkti ruumikuju, pühapaiga lähemal vaatlusel aga kasutada hoopis polügooni ruumikuju, eristada selle sees omakorda teisi polügoone või punkte jne. Joonis 1.18: Pringi Ohvrimägi punktina ja polügoonina (Hiite Maja looduslike pühapaikade kaardirakendus) Joonis 1.19: Pringi Ohvrimäe raietööd (Kaasik 2018) Vektorandmete struktuur võib olla väga erinev. Kõige lihtsamas struktuuris on iga objekt (punkt, joon või polügoon) kirjeldatud x- ja y-koordinaatide jada kaudu. See tähendab ka näiteks, et teineteisega külgnevad polügoonid on kirjeldatud eraldi joonelõikude kaudu, olgugi et neil on osa lõike ühised. Sellises struktuuris ei ole objektidevahelised suhted kuidagi kirjeldatud ning külgnemissuhe on implitseeritud ainult samasuguste koordinaatide kaudu. Teine levinud viis andmeid struktureerida on kasutada topoloogilisi suhteid, mis kirjeldaksid ruumiobjektide paiknemissuhteid nii, et need mingite teisenduste (nt pööramise või suumimise) käigus ei muutuks. Näiteks külgnevate polügoonide puhul teaks sellisel juhul polügoonide ühine joonelõik, et tema parem pool kuulub ühte polügooni ja vasak pool teise ning kaob ära vajadus samu koordinaate kaks korda määrata. Topoloogilised suhted võivad niisiis kirjeldada nt seda, kas kaks objekti on kõrvuti või puutuvad kokku, kas üks objekt on täielikult või osaliselt teise sees, kas kaks objekti jagavad ühist piiri/serva, kas kaks objekti on üksteisest täiesti eraldi jne. Joonis 1.20: Spagetistruktuur vs. topoloogiline struktuur (Bolstad 2016 : 48) Topoloogilised suhted on aluseks topoloogiareeglitele, mis defineerivad, kuidas geomeetrilised objektid geoinfosüsteemi andmebaasis tohivad üksteise suhtes paikneda. Topoloogiareeglid ArcGISis Topoloogilisi suhteid ja reegleid kasutatakse näiteks siis, kui tahetakse planeerida võimalikult kiiret teekonda ühest punktist teise või hoonestuse paiknemist, aga ka paljuks muuks. Pelgaks visualiseerimiseks pole aga topoloogilisi suhteid andmebaasis vaja defineerida. Vektorandmeid hoitakse GISis enamasti kas SHP, GML, TAB või VPF formaatides. Nii vektor- kui ka rasterandmeid saab hoida geopackage’i (GPKG) formaadis. 1.5.2 Rasterandmed Rastermudelit kasutatakse eeskätt pidevate andmeobjektide (nn väljade) kujutamiseks. Rastermudelis jagatakse kogu ruum ühesuguste (kindla kujuga) osadega korrapäraseks võrguks ehk rastriks, nii et igale rastri elemendile saaks koordinaatide abil ühtmoodi viidata ning väljal ei oleks kattumisi ega tühimikke. Rastermudel peaks olema tõenäoliselt juba tuttav, kui oled kokku puutunud näiteks digifotodega või muude digiteeritud piltidega. Formaadid, nagu JPEG, TIFF, GIF jm, põhinevad kõik rastermudelil. Samuti põhinevad rastertehnoloogial nt kõiksugu LCD-monitorid. Joonis 1.21: Rastermudeli struktuur (Bolstad 2016 : 54) Rastri üht elementi nimetatakse tavaliselt piksliks (pixel ehk picture element). Pikslid võivad olla igasuguse kujuga (nt kolmnurgad, kuusnurgad), ent enamasti on need siiski ruudukujulised. Olgugi, et piksel on olemuselt alati kahemõõtmeline, on piksli koordinaatideks selle keskpunkti koordinaadid. Ühel pikslil on terves oma ulatuses üks väärtus (vastaval alal kõige tüüpilisem või keskmine väärtus), mis täpsustab näiteks selle piksli värvi ja/või heleduse ning iseloomustab selle kaudu piksliga piiratud alas asuva ruumilise nähtuse mingit omadust. Selline omadus võib olla nii pidev (nt kõrgusinfo, mingi keelelise konstruktsiooni suhteline kasutussagedus) kui ka diskreetne (nt keelendi A vs. keelendi B kasutus). See, kui täpselt rastermudel mingile reaalse maailma andmeobjekti kujule vastab, sõltub sellest, kui suured on ühe rastri elemendi ehk piksli mõõtmed, ehk sellest, kui suur on resolutsioon ehk eraldusvõime/lahutusvõime. Mida kõrgem on eraldusvõime, seda täpsem rastermudel on, ent seda suurem on ka rasterandmete faili suurus; mida madalam on eraldusvõime, seda enam infot läheb kaotsi. Efektiivseks eraldusvõime määramiseks tuleks arvesse võtta nii kaardi mõõtkava kui ka muude kaardistatavate andmete väikseimat ühikut. Joonis 1.22: Rastri resolutsioon (Bolstad 2016 : 55) GISi seisukohast on eraldi liik rasterandmeid satelliitpildid, aerofotod ja ortofotod, mis pakuvad GISile olulist kontekstilist infot. Satelliitide eri sensorite ja kaamerate abil saadud info abil on võimalik kuvada suurt hulka maapinna omadusi ja protsesse. Erinevad satelliidid annavad erineva kvaliteediga pilte. Joonis 1.23: EstCube-1 tehtud satelliitpilt (https://www.estcube.com/) Vaata värskemaid NASA satelliitpilte siit. Aerofotosid saab teha näiteks õhupallist, kopterist või lennukist, üha enam kasutatakse fotoroboteid. Aerofotod võivad oma läätse tõttu olla servadest moonutatud ning samuti võivad moonutatud olla maapinnast kõrgel olevad objektid (nt tornid, korstnad, tipud). Ortofotod on geomeetriliselt parandatud aerofotod. Joonis 1.24: Aerofotod vs. ortofotod (Open Geospatial Education) Rastreid võib aga saada ka vektorandmete teisendamisel või interpoleerimisel rasterkujule. Sellisel juhul võib pidada üheks rastri elemendiks nn rakslit ning selle väärtus viitab enamasti mingi ruumiobjekti ID-le või mingi atribuudi väärtusele. Joonis 1.25: Vektorandmetest rasterandmeteni (Timo Grossenbacher, 2018) Rasterandmete levinumad formaadid on näiteks JPEG, PNG, TIFF, BMP. 1.5.3 Vektor vs. raster Vektorandmed Rasterandmed andmestruktuur võib olla keerukas andmestruktuur on lihtne vähem mahukad võivad olla väga mahukad sobivad ruumiobjektide piiritlemiseks või nende asukoha keskpunktide määramiseks sobivad paremini mingil alal esineva (pideva) nähtuse iseloomustamiseks sobivad paremini inimtegevuse kujutamise jaoks sobivad paremini keskkonna- või loodusnähtuste jaoks sobivad paremini konkreetsetele nähtustele paljude atribuutidega sobivad paremini komplekssetele nähtustele väheste atribuutidega sobivad paremini täpsete, konkreetsete andmetega sobivad paremini ebatäpsete/puudulike või üldistavate andmetega võib arvestada ka topoloogilisi suhteid enamasti objektidevahelisi suhteid ei arvesta on vähem tundlikud projektsiooni muutmisele võivad olla väga tundlikud projektsiooni muutmisele kaardid on visuaalselt ilusamad kaardid suhteliselt robustsed Mõttepaus: Kumba mudelit kasutaksid riigimaanteede kaardistamiseks? Miks? Kumba mudelit kasutaksid rahvastikutiheduse mudeldamiseks? Miks? Millisel kujul saaksid kujutada enda uurimisainest? Paljud tänapäeva GIS-tehnoloogiad võimaldavad kasutada mõlemat mudelit paralleelselt. Näiteks digitaalsed maastikumudelid kuvavad sageli rasterandmete abil mingi piirkonna reljeefi või maakasutust, punktide abil huvipakkuvaid hooneid, joonte abil jõgesid ja teid ning polügoonide abil haldusjaotust. Sealjuures võib otsustada, kas kuvada näiteks kirikud, haiglad ja haridusasutused eraldi kihtidel või ühe kihina, milles sisaldub hoone funktsiooni määrav atribuut. Joonis 1.26: Maastiku nähtavuse analüüsimine (Kimber 2016) Samuti võib üht ja sama nähtust kuvada erinevat moodi, nii vektori kui ka rastrina. Joonis 1.27: Tänavaröövid Saitamas (Okabe 2006 : 8) Vaata natuke ringi siin ja siin. Kas saad aru, millist tüüpi mudeleid on kasutatud? Vaata ka 30 Day Map Challenge käigus tehtud kaarte (siin). "],["kaardid.html", "Praktikum 2 Kaardid, koordinaatsüsteemid ja projektsioonid 2.1 Kaart 2.2 Kaardi elemendid 2.3 Kaartide liigitus 2.4 Kaartide koostamine ja kujundamine veebis", " Praktikum 2 Kaardid, koordinaatsüsteemid ja projektsioonid 2.1 Kaart Kaart on maapinna või muu taevakeha vähendatud, üldistatud ja leppemärkidega seletatud mõõtkavaline tasapinnaline kujutis. (Mõisja 2019: 533) Kaardi tunnusteks on seega matemaatilised seaduspärad: kuidas reaalne maailm kaardile kanda? leppemärgid: mille kaudu reaalset maailma kaardil kujutada? üldistatus: kui abstraheeritud pilti reaalsest maailmast kujutada?. Kitsamas tähenduses on kaart niisiis geograafilise informatsiooni visuaalne esitusviis. Joonis 2.1: Väljavõte Maa-ameti Eesti aluskaardist (Maa-amet) Laiemalt räägitakse ka kartograafilistest kujutistest (või kaarditoodetest) (Mõisja 2019: 534), mille hulka võivad lisaks klassikalistele kaartidele kuuluda veel näiteks joonised (väike mõõtkava, suur üldistusaste, ei peegelda täpseid asukohti; Tallinna transpordiühenduste joonis (Eesti Disaini Keskus) kartogrammid (väike mõõtkava, esitab kvantitatiivset infot, vastab mõõtkavatäpsusele; sageli sama, mis horopleetkaart). Ingliskeelne cartogram viitab natuke erinevale asjale, nn pindalakaardile, mis moonutab alasid vastavalt mingile kvantitatiivsele tunnusele; Vaadeldud ja ennustatavad suve keskmised temperatuurid Euroopas (horopleetkaart) (Evelyn Uuemaa) plaanid (suur mõõtkava, topograafiline või tehniline, ei kasuta projektsiooni); Kvartali keskuse juurdeehituse plaan (Tartu Linnavalitsus) Samuti võib käsitleda eraldi nn piltkaarte, kus oluline pole geograafiline täpsus, vaid kunstiline esteetika. Joonis 2.2: Marleen Eino Tartu kaart Joonis 2.3: Puise küla kaart (Herald Eelma, Ilmar Randmaa, Merike Liivlaid) Piir piltkaartide ja kunsti vahel ei ole siinjuures sugugi selge. Joonis 2.4: Markus Kasemaa töid Kaarti (või siis kartograafilist kujutist) tehes peame esmalt läbi mõtlema, mis on kaardi tegemise eesmärk ning kes on kaardi lõppkasutaja. Seejärel tuleb mõelda, mida ja mis kujul reaalsest maailmast esitada ning kui täpne peab esitus olema. Lõpuks tuleb mõelda ka tehnilistele aspektidele: mis formaadis andmed meil on kasutada, mis formaadis need andmed peavad olema kaardi tegemiseks ning mis formaadis tuleb kaart ise. 2.2 Kaardi elemendid Klassikalisel kaardil on lisaks sisule (sellele, mida kaardiväljal leppemärkide kaudu kujutatakse) hulk elemente, mis aitavad kaardil kujutatut paremini mõista, näiteks legend (seletab leppemärke), pealkiri, diagrammid, põhjasuund, kaardivõrgud, -kirjad, marginaalkirjad, matemaatiline alus (mõõtkava, projektsioon), lisainfo (väljalõiked, pildid, tekstid jne). Joonis 2.5: Kaardi elemendid (Mõisja 2019: 539) 2.2.1 Mõõtkava Kaardi mõõtkava näitab, kui palju reaalset objekti on vähendatud. Tavaliselt väljendatakse mõõtkava murdosa või suhtena, mis seob kaardil esitatud mingi pikkusega joonlõigu sama joonlõiguga maapinnal. Näiteks mõõtkava 1/20 000 või 1:20 000 näitab, et 1 ühik kaardil vastab 20 000 samale ühikule reaalses maailmas. Kui ühik on cm, siis esitab 1 cm kaardil 20 000 cm ehk 200 m maapinnal. Kaardid jagatakse üldiselt suuremõõtkavalisteks (nt 1:10 000) ja väikesemõõtkavalisteks (nt 1:1 000 000), ehkki seda, kust läheb nendevaheline piir, ei ole selgelt kokku lepitud. Väikesemõõtkavalised kaardid katavad niisiis suuremat ala ja suuremõõtkavalised kaardid väiksemat ala, ehkki intuitiivselt võidakse tajuda neid mõisteid vastupidiselt (“väike kujutab väikest ja suur suurt”). Digitaalsetel kaartidel esitatakse mõõtkava sageli dünaamiliselt, mis tähendab, et mõõtkava saab sisse või välja suumides muuta. Samuti on tüüpiline mõõtkava esitamine mitte arvmõõtkavana, vaid visuaalselt: mingile ekraanil määratletud joonlõigule vastab tegelikkuses kindel vahemaa maapinnal, ent me ei pruugi täpselt näha, kui pika joonlõiguga on ekraanil tegemist. Kui liigume suurelt mõõtkavalt väiksemale, peame andmeid loetavuse huvides üldistama ning valima, mida ja mis detailsusastmega esitada. Üldistada võib lihtsustades, siludes, ühendades jne. 2.2.2 Koordinaatsüsteemid ja projektsioonid Ruumiandmed on alati seotud mingi kohaga. Maakera on kolmemõõtmeline ja põhimõtteliselt võiksime üsna hästi kasutada objektide asukoha ja omaduste kujutamiseks gloobust. See aga ei ole sageli kuigi praktiline. Kaardil, mis on märksa praktilisem visualiseerimisvahend, on üldjuhul aga ainult kaks mõõdet. Kuidas siis kolmemõõtmelist ning ebakorrapärast kujundit kujutada kahemõõtmelise ja korrapärase meediumi kaudu ning kuidas paigutada reaalse maailma objekte ja alasid nii, et saaksime kaardi põhjal öelda, kus need maakeral asuvad? Esmalt tuleb objektid ja nähtused siduda mingite koordinaatidega. Koordinaadid on arvud, mis määravad punkti asendi tasandil või ruumis ning koordinaatsüsteem vastavalt teatud reeglitel põhinev raamistik, mida nende arvude määramiseks kahe- või kolmemõõtmelises ruumis kasutatakse. Ühtse koordinaatsüsteemi abil on võimalik siduda ja koos esitada erinevaid andmeid, ent kui tahame määrata koordinaate maapinnal, siis koordinaatsüsteemist üksi ei piisa. Vaja on siduda see ka Maa kui füüsilise keha ja selle kujuga. Maa tegelik füüsiline kuju on ebakorrapärane ja pidevalt muutuv ning seda on väga raske adekvaatselt mõõta. Maa pinna geofüüsilist mudelit nimetatakse geodeesias geoidiks, mis esitab Maa kuju tingimustes, kus see sõltuks ainult gravitatsiooniväljast ja Maa pöörlemisest. Joonis 2.6: Geoid (Aleš Bezděk, https://www.asu.cas.cz/~bezdek/vyzkum/rotating_3d_globe/index.php) Geoid on samuti üpris keerukas ning korrapäratu vorm, sest Maa tihedus ja mass on ebaühtlaselt jaotunud. Kuna geoid esitab teoreetilist merepinna taset, kus tõusud-mõõnad, tuuled jms ei mängi mingit rolli, võimaldab see üsna täpselt määrata nt objektide kõrgust, ent see ei sobi see väga hästi nn horisontaalsete koordinaatide määramiseks. Seepärast kasutatakse pikkus- ja laiuskraadide määramiseks, kauguste ja pindalade arvutamiseks ning kaartide tegemiseks referentspinnana enamasti ellipsoidi kui Maa idealiseeritud matemaatilist mudelit. Erinevate ellipsoidide mõõtmed võivad pisut erineda (nt nende pooltelgede pikkused või ellipsoidi lapikus). Joonis 2.7: Geoid, ellipsoid ja maapind (allikas: Maa-amet) Ellipsoid ja selle orienteerimise parameetrid (nt kus on ellipsoidi keskpunkt või millise maapinna punkti järgi see on orienteeritud) moodustavad nn daatumi ehk geodeetilise referentssüsteemi. Daatum määrab ära, kui täpselt mingi ellipsoid geoidi pinnale vastab (kui lähedal need teineteisele on). Lokaalsed daatumid, mis ei ole tingimata seotud Maa keskpunktiga, sobivad mingile väikesele maa-alale paremini, sest järgivad selles konkreetses kohas paremini Maa tegelikku kuju, ent ei ole hästi kasutatavad teistes kohtades. Eestis kasutatakse tänapäeval globaalset geotsentrilist ellipsoidi GRS80, mis on praktiliselt identne palju laialdasemalt kasutusel oleva globaalse WGS84 ellipsoidiga. Joonis 2.8: Erinevad daatumid: globaalne, geotsentriline WGS84 ja lokaalne NAD27 (allikas) Daatumi ja sobiliku koordinaatsüsteemi abil saamegi määrata objektide asukohti Maa pinnal: teame, millise kujuga ja mõõtmetega kujutame Maad ette, ning teame ka, millistes ühikutes ja millisest nullpunktist lugedes me sellel kujul objektide asukohti määravaid koordinaate arvestame. Geograafilised koordinaadid on alati seotud mingi daatumiga ning aitavad meil määrata objekti asukoha, kasutades pikkus- ja laiuskraade. Pikkuskraade loetakse kahele poole mingit meridiaani, tüüpiliselt Greenwichi observatooriumi meridiaani, (idapikkus ja läänepikkus), laiuskraade kahele poole ekvaatorit (lõunalaius ja põhjalaius). Asukohta esitatakse kraadides (°), minutites (’) ja sekundites (“) või kraadides kümnendsüsteemis. Mõtteharjutus: Kui iga kraad on jagatud 60 minutiks ja iga minut 60 sekundiks, siis kuidas kujutada kümnendsüsteemis koordinaate 58°22’48”N, 26°43’20”E? Selleks aga, et nüüd geograafilises ruumis paiknevaid objekte kujutada tasapinnalisel mudelil ehk kaardil, peame valima kaardi projektsiooni, mis määrab matemaatilise viisi, kuidas sfääriline pind tasapinnal esitatakse ning kuidas ruumilised koordinaadid (GCS) konverteeritakse ümber tasapinnalisteks koordinaatideks (PCS ehk projected coordinate system), mida väljendatakse x-i ja y abil. Sisuliselt määrab projektsioon ära ka selle, milliseid alasid maakeral me oleme nõus oma kaardil rohkem moonutama ja milliseid vähem ning mispidi me mingeid alasid kaardil venitame või kokku surume. Kui tahame kujutada ümmargust Maad kahemõõtmelisel tasapinnal, siis paratamatult peame mingit osa maakerast moonutama. Ühe või teise projektsiooni valimisel moonutame rohkem kas pindalasid, nurkasid, kujusid või joonpikkuseid. Joonis 2.9: Erinevad projektsioonid (allikas: Compare Map Projections) Projektsioonid jagunevad üldisteks tüüpideks selle järgi, kas ruumilist maakera üritatakse projitseerida silindrile, koonusele või tasandile. Need üldised tüübid jaotatakse omakorda selle järgi, kuidas vastav siirdepind on maaellipsoidi suhtes orienteeritud (normaal-, põik- või kaldaspekt). Joonis 2.10: Projektsioonitüübid (Aunap 2019: 169) Kõige tuntum ja enimkasutatud projektsioon on silindriline Mercatori projektsioon, mis on 16. sajandil nime saanud hollandi meresõitja Gerardus Mercatori järgi. Projektsioon moonutab nende alade suurusi ja kaugusi, mis jäävad ekvaatorist kaugemale põhja või lõuna poole, ent säilitab samas hästi nurgad. Nii oli võimalik merel näiteks otse mööda mingit pikkus- või laiuskraadi sõites jõuda välja õigesse kohta. Mercatori projektsiooni on 20. ja 21. sajandi jooksul palju kritiseeritud just alade suuruse moonutamise pärast, kuna see mõjutab mh inimeste ettekujutust kehtivatest võimusuhetest. Ehkki Mercatori (või õigemini veebi-Mercatori) projektsioon on põhiline projektsioon, mida kasutatakse veebikaartidel, on atlastes sellest tänapäeval suuresti loobutud ning kasutatakse pigem muid projektsioone (nt Robinsoni, Mollweide või Winkel-Tripeli projektsiooni). Projektsioonide arv on aga põhimõtteliselt lõpmatu, kuna olemasolevaid projektsioone on võimalik matemaatiliselt pidevalt muuta, et teha need sobivaks justnimelt mingile alale või mingiks ülesandeks (nt lennunduse jaoks). Riikidel on üldjuhul välja kujunenud oma riiklikud standardid (sh projektsioonid), mida riiklike ruumiandmete puhul kasutatakse. Eestis kasutatakse üldjuhul projektsiooni koodiga EPSG:3301, mis põhineb Lamberti konformsel koonilisel projektsioonil. Toredaid vidinaid projektsioonide võrdlemiseks leiab näiteks järgmistelt lehekülgedelt: Compare Map Projections Comparing Map Projections Projection Face Map Projection Transitions Lõpetuseks. GIS-tarkvarades kohtad mõistet koordinaatide referentssüsteem (CRS - Coordinate reference system), mis koosneb daatumist ja projektsioonist. 2.3 Kaartide liigitus Kaarte võib liigitada põhimõtteliselt kõikide tema omaduste või elementide põhjal, samuti sisu põhjal. Levinud liigitusalused on näiteks teema: üldgeograafilised (nt looduslikud nähtused ja inimtekkelised objektid maapinnal), temaatilised (esitab mingi kategooria infot kaardil, nt majandus, kultuur, ajalugu, rahvastik, kliima vm; sageli koos aluskaartidega), erikaardid; mõõtkava: suuremõõtkavalised, keskmisemõõtkavalised, väikesemõõtkavalised, funktsioon: teaduslik kaart, katastrikaart, propagandakaart, turismikaart, teekaart, merekaart, … 2.3.1 Digitaalkaardid Üha rohkem puutume tänapäeval paberkaartide asemel kokku digitaalkaartidega. Ehkki mõlemal juhul näeme kaardil seda infot, mida kaardi tegija soovib edastada, ning sellisel kujul, nagu tema vajalikuks peab, on paber- ja digitaalkaartidel olulisi erinevusi. Joonis 2.11: Digitaal- vs. paberkaart (Suurna et al. 2010: 26) Digitaalkaardi eriliik on omakorda veebikaart, millest räägime lähemalt hilisemates praktikumides. 2.3.2 Viguriga kaardid Eri Eestiga seotud nähtuste (kohati väga loomingulist) kujutamist kaartidel võib vaadata näiteks Taavi Pae koostatud raamatust “Viguriga kaardid” (2022). 2.3.3 Ülesanne Kujuta ette, et Google Mapsi ei ole veel leiutatud ja paberkaardid on väga kallid, aga sulle on Tartusse külla tulnud sõber / perekonnaliige / tuttav / välismaa sõber, kes ei ole siin kunagi varem käinud. Joonista tema jaoks paberile Tartu kesklinna kaart ning lisa kaardile enda või tema jaoks tähtsamad kohad ning tagaküljele kirjuta ka, kellele kaart on mõeldud. 2.4 Kaartide koostamine ja kujundamine veebis Veebis on üksjagu valmis kaardirakendusi (nt Google My Maps, PinMaps, Scribble Maps, ZeeMaps või spetsiaalselt humanitaarteadlastele mõeldud Palladio), mis võimaldavad teha ruumiandmete päringuid, võrdlemisi vähese vaevaga lihtsamaid analüüse (nt leia lühim/kiireim teekond punktist A punkti B) ning lisaks pakuvad mõned platvormid lisaks platvormi kaudu leitava info kasutamisele võimalust integreerida nendega ka enda andmeid ning kas või luua uusi ruumiandmeid. Lisaks sellele, et on võimalik enda andmeid n-ö olemasolevas süsteemis kuvada, pakuvad mõned platvormid võimalust ka ise aluskaardi tegemisel kaasa lüüa. Sellised on näiteks OpenStreetMap, WikiMapia ja Here WeGo, mis töötavad sarnaselt Vikipeediale: kasutajad saavad kaardi informatiivsust ja kvaliteeti ise parandada, lisades kaardile hooneid, teid jm objekte ning täiendades või parandades olemasolevate objektide infot. 2.4.1 ArcGIS Online Vaatame täna lähemalt ArcGIS Online’i võimalusi kaartide kujundamiseks ja enda andmete kujutamiseks. Selleks tuleb endale kõigepealt luua keskkonnas avalik konto ning seejärel keskkonda sisse logida. Kui oled sisse loginud, vali menüüribalt jaotis Map, mis viib sind nende Map Vieweri rakendusse. Joonis 2.12: ArcGis Online’i Map Viewer Vasakul vertikaalsel menüüribal saad lisada oma kaardile andmekihte (plussmärk), vaadata olemasolevaid kihte (Layers), atribuuttabeleid (Tables), valida aluskaarte (Basemap), lisada ja vaadata diagramme (Charts), kaardi legendi (Legend), kaarti salvestada ja salvestatud kaarte avada (Save and Open), vaadata üldisi kaardi sätteid (Map properties) ning kaarti välja printida. Parempoolsel vertikaalsel menüüribal saab määrata, kuidas meie erinevad kaardikihid välja näevad. 2.4.1.1 Aluskaart Valime esmalt oma andmetele aluskaardi. Aluskaart toimib tavaliselt teemakaardi kontekstina ega paku uurijale omaette huvi. Aluskaardi valimiseks vali vasakult menüüst Basemap ja seal pakutute hulgas mõni endale meelepärane kaardistiil. Joonis 2.13: Aluskaardi valimine Kaardistiili on võimalik ka pisut oma maitse järgi kohandada, valides nt Basemap -&gt; Current basemap, sealt muudetav aluskaardi kiht. Parempoolsest menüüst saab seejärel teha kaarti heledamaks või tumedamaks, muuta värvigammat, läbipaistvust jms. Näiteks võiksime püüda ära kaotada kohanimesildid, tänavad jms, kui neid meie teemakaardi jaoks tingimata vaja ei lähe (näiteks siis, kui meie kaart on väikese mõõtkavaga), ning teha kaarti veidi heledamaks. Joonis 2.14: Aluskaardi muutmine 2.4.1.2 Andmekihi üleslaadimine Nüüd lisame aluskaardile enda andmete kihi. Kasutame siin näitlikustamiseks üht väikest osa 19. sajandi teise poole Lõuna-Eesti vallakohtuprotokollidest, mille 2000. aastatel sisestas digitaalsel kujul Tõnis Türna (Rahvusarhiiv). 2016. aastal taastati algselt http://www.history.ee/vallakohus lehel olnud protokollid veebiarhiivide põhjal ning 2018-2019 katsetati nende peal eesti keele automaatset morfoloogilist analüsaatorit (Pilvik et al. 2019). Morfoloogilise analüsaatori ülesandeks on tunda ära sõnavorm (nt obbesel) ning pakkuda sellele sõnaraamatukuju (hobune), sõnaliik (S ehk substantiiv ehk nimisõna), vormiinfo (sg ad ehk singulari adessiiv ehk ainsuse alalütlev kääne) jm. Automaatses analüüsis tundmatuteks jäänud sõnavormide osakaal on umbkaudseks indikaatoriks sellele, kui erinev oli vastava protokolli keel tänapäeva keelest. Joonis 2.15: Vallakohtuprotokolli näide xml-kujul (Pilvik et al. 2019) Laadi endale Moodle’ist alla andmetabeli fail vallakohtuprotokollid1.csv, mis sisaldab semikoolonitega eraldatud tulpades järgmist infot: - Vald - valla nimi, - L/P - kas vald kuulus 19. sajandil põhja- või lõunaeesti keele kõnelemispiirkonda, - Norm - kas selle valla kohtuprotokollide keelt oli sisestamisel normaliseeritud kirjakeelele vastavamaks või mitte, - Kihelkond - kihelkond, mille alla vald paigutub, - Kih_id - kihelkonna lühend, - Murre - murdeala, mille alla vald paigutub, - Maakond - maakond, mille alla vald paigutub (NB! tänapäevane!) - Latitude - laiuskraad (põhi-lõuna), - Longitude - pikkuskraad (ida-lääs), - Protokolle - sisestatud protokollide arv, - TundmatuteProtsent - keskmine selle valla protokollides tundmatuks jäänud sõnade protsent, - Algus - valla kõige varasema protokolli kuupäev, - Lõpp - valla kõige hilisema protokolli kuupäev. Selleks, et andmed ArcGIS Online’i saada, valime vasakult vertikaalsest menüüst plussmärgi Add -&gt; Add layer from file. Lubatud formaadid on CSV (Comma-separated values ehk andmetabel, mille välju/tulpasid eraldavad komad), GeoJSON (ruumiandmete andmebaasiformaat) ja KML (Keyhole markup language ehk üks ruumiandmete standardformaate, mh kasutab seda nt Google Earth). Meie andmed on CSV-formaadis. Üleslaadimisel kuvatakse andmetabelis olevad atribuudid ja nende tüübid. Näeme näiteks, et pikkus- ja laiuskraadid, protokollide arv ja tundmatute analüüside protsent on õigesti tuvastatud arvuliste atribuutidena, protokollide kuupäevad kuupäevadena ja ülejäänud tunnused on tekstilised/kategoriaalsed. Joonis 2.16: Andmete atribuuttabel Järgmiseks küsitakse, millises tulbas on pikkus- ja laiuskraadid, et oleks punkte kuskile paigutada. Meie punktide koordinaadid on sobivasti juba Longitude- ja Latitude-nimelistes tulpades. Laadime punktid kaardile. 2.4.1.3 Andmekihi stiliseerimine Parempoolsest menüüst saame muuta punktide kuju, suurust, läbipaistvust, nähtavust (nt kas punktid on näha alles mingil sissesuumimise tasemel või kogu aeg) jpm. Teeme esmalt punktid pisut suuremaks ja veidi läbipaistvamaks, et näha paremini ka neid, mis üksteise alla jäävad. Selleks valime Styles -&gt; 2 Pick a style -&gt; Location (single symbol) -&gt; Style options -&gt; Symbol style. Joonis 2.17: Punktide muutmine Võime punktide konkreetse paiknemise asemel vaadata rastrina ka punktitihedust (mis piirkondadesse punktid koonduvad? kust meil rohkem andmeid on?), ehkki nii väheste punktide arvu korral pole see kuigi otstarbekas. Selleks valime Styles -&gt; 2 Pick a style -&gt; Heat Map. Heat map’idest ehk tiheduskaartidest räägime sel kursusel lähemalt geostatistika praktikumides. Joonis 2.18: Heat map 2.4.1.4 Atribuutide väärtuste kujutamine Selle asemel, et näidata lihtsalt meie andmepunktide paiknemist ning stiliseerida kõiki punkte ühtmoodi, võime kaardi muuta ka pisut informatiivsemaks ning kujutada punktide kujunduslike elementide (nt suuruse, kuju, värvi, läbipaistvuse) kaudu mingeid andmetabeli atribuute ehk tunnuseid, mis neid punkte kuidagi iseloomustavad. Map Vieweris saame vaikimisi kaardil kuvada korraga vaid üht tekstilist/kategoorilist ja üht arvulist tunnust. Kategoorilisi tunnuseid kuvatakse enamasti näiteks sümboli kuju või värvi kaudu (nt eri kihelkondade punktid on erineva kujuga), arvulisi tunnuseid aga sümboli suuruse, värvitooni heleduse-tumeduse või läbipaistvuse kaudu (näiteks mida rohkem on vallast protokolle, seda suurem on valla sümbol). Valime tekstilise/kategoorilise tunnuse L/P, et näidata, millised vallad kuuluvad põhjaeesti ja millised lõunaeesti keele kõnelemise piirkonda. Valime arvulise tunnuse TundmatuteProtsent, et näidata, kui suur protsent sõnadest endale tänapäevase keele automaatanalüüsi vahenditega mingit analüüsi ei saanud (= milliste valdade protokollide keel on tänapäeva keelest kõige erinevam?). Selleks valime parempoolsest menüüst Styles -&gt; 1 Choose attributes ja lisame + Field nupust tunnused L/P ja TundmatuteProtsent. Vajutame Add. Nüüd näeme, et punktide värvi kaudu näidatakse, kumma keelevariandi kõnelemise alale vallad jäävad, ning suuruse kaudu seda, kui keeruline on automaatse analüüsi vahendite jaoks vastava valla protokolli keel (mida suurem punkt, seda keerulisem). Saame neid kujutusviise omakorda muuta, kui valime nüüd Styles -&gt; 2 Pick a style -&gt; Types and Size -&gt; Style options. Kategoriaalsete tunnuste väljanägemise muutmiseks valime Types (unique symbols) -&gt; Style options ning arvuliste tunnuste jaoks Counts and Amounts (size) -&gt; Style options. Tegeleme kõigepealt kategoriaalsete tunnustega: Types (unique symbols) -&gt; Style options: Muudame kõik punktid läbipaistvamaks: Symbol style -&gt; Fill transparency. Punktide piirjooned võiksime teha mingit muud värvi ja ka suhteliselt läbipaistvaks: Symbol style -&gt; Outline color ja Outline transparency. Teeme põhjaeesti keele punktid roheliseks ja lõunaeesti omad kollaseks: L/P -&gt; vajuta kummagi väärtuse sümboli peal (Change symbol). Joonis 2.19: Punktide kujundamine kategoriaalse tunnuse alusel Seejärel muudame punktide suuruse skaalat, mis näitab seda, kui suur on tundmatute analüüside protsent igas vallas: Counts and Amounts (size) -&gt; Style options: Määrame punktide suuruse lineaarselt vastavalt protsentide absoluutväärtustele: Size range (7-52). Joonis 2.20: Punktide kujundamine arvulise tunnuse alusel Lõpetuseks võiksime veel lisada punktidele juurde vastavate valdade nimed. Selleks valime paremalt menüüst Labels -&gt; Enable labels -&gt; Add label class ja määrame Label field väärtuseks tunnuse Vald. Selleks, et muuta seda, kuidas sildid välja näevad, valime Label style -&gt; Edit label style. Joonis 2.21: Siltide lisamine 2.4.1.5 Kaardi salvestamine ja jagamine Nüüd võime oma kaardi näiteks välja printida või faili salvestada, kui valime vasakult menüüst Print. Selleks, et kaarti oma ArcGISi keskkonda salvestada, valime vasakult Save and Open -&gt; Save as. Kaardi jagamiseks valime vasakult Share map -&gt; Everyone (public). Saame kasutada kaarti nüüd näiteks oma ArcGISi kaardilugude põhjana või jagada seda URLi. Kui tahame kaardi nt HTMLi iframe’i märgendite abil teiste veebilehtede koodi sisse panna, peame kasutama Map Vieweri asemel praegu aga veel Map Viewer Classic rakendust. Joonis 2.22: Sama kaart Map Viewer Classicus Sealt võib valida Share -&gt; Embed this map -&gt; Embed in website ning kopeerida sobivate sätetega HTML-koodi oma veebilehe koodi sisse. Joonis 2.23: Kaardi kasutamine HTML-veebilehtedel Selle abil (või lihtsama iframe’i koodi abil) saab näidata sama kaarti ka nt siin kursuse kodulehe materjalides. &lt;iframe width=&quot;100%&quot; height=&quot;400&quot; frameborder=&quot;0&quot; src=&quot;https://www.arcgis.com/apps/Embed/index.html?webmap=ac8c6897263f408f89cfdf3d01cfd789&amp;extent=21.6531,56.9512,29.7665,59.5763&amp;zoom=true&amp;previewImage=false&amp;scale=true&amp;legend=true&amp;disable_scroll=false&amp;theme=light&quot;&gt;&lt;/iframe&gt; 2.4.2 Mapbox Studio Varasematel aastatel oleme kasutanud ka Mapbox Studiot. Ehkki suur osa Mapboxi teenuseid on tegelikult sellisele tavakasutajale, kelle kaarte ei vaadata veebis ühes kuus kümneid tuhandeid kordi, tasuta ning arve esitatakse alles siis, kui tasuta kasutuse limiit on ületatud, nõutakse nüüd konto registreerimisel ka krediitkaardi numbrit. Seetõttu on Mapboxi kasutamine sellel kursusel vabatahtlik ja järgnev materjal pigem lisa neile, kel asja vastu huvi. Mapbox on platvorm, mis pakub erinevaid tööriistu kaartide tegemise ja ruumiandmete analüüsiga seotud probleemide lahendamiseks (eelkõige veebis). Lisaks paljule muule võimaldab ka Mapbox veebipõhiselt oma andmete kujutamist kaardil ning üsna ulatuslikku kaartide stiliseerimist (Mapbox Studio). Mapboxis võid muuta näiteks kaardi värviskaalat, läbipaistvust, piirjoonte paksust, teksti suurust, fonti, keelt, objektide omadusi, ikoone, ühendada satelliitpildi jpm. Kaarti saab ka teha täiesti nullist ning valida olenevalt kaardi tegemist eesmärgist, milliseid kihte kaardil kuvada. Kaardi saab eksportida pildifailina ning kaardi stiili svg-failidena; stiili saab eksportida ka otse QGISi või ArcGISi või ka muudele platvormidele. Kuna Mapbox pakub ulatuslikku kontrolli kaardi väljanägemise üle, sobib see hästi ka story map’ide aluskaartide tegemiseks, kui on oluline, loo juurde käiks kvaliteetne visuaal (story map’ist räägime järgmisel korral). Mapboxi kasutamine eeldab, et oled registreerinud end kasutajaks. Kui oled sisse loginud, mine lehele Studio. Avaneb leht, mille ülaosas on kolm sakki: Styles, Tilesets ja Datasets. Joonis 2.24: Mapbox Studio Tileset on Mapboxi ruumiandmete formaat (nii raster- kui ka vektorandmetele), mida kasutatakse andmete kaardil esitamiseks. Võid importida oma andmed Mapboxi valmis tileset’ina või kasutada Datasets sakki, et laadida oma andmed üles, neid soovi korral töödelda (nt muuta arvulised atribuudid tekstiks või vastupidi, nt “6” -&gt; 6) ning seejärel tileset’i vormingusse konverteerida. 2.4.2.1 Kaardistiili kohandamine Proovime võtta esmalt lahti mingi olemasoleva stiili, uurida pisut selle komponente ning muuta mingeid kaardi parameetreid. Selleks vali sakk Styles -&gt; New style. Joonis 2.25: Vali kohandatav stiil Vaatame esmalt, mis projektsioonis kaart on esitatud, ning mängime pisut ka teiste projektsioonidega. Selleks vali 3D -&gt; Projection. Mapboxi projektsioonide kohta võid lugeda rohkem siit ja siit. Joonis 2.26: Kaardi projektsioon Sisse suumides kohandab Mapbox mis tahes projektsiooni tasapisi veebikaartidele kõige tüüpilisema projektsiooni ehk Mercatori projektsiooni suunas. Saame lisada kaardile soovitud komponente (nt teed, loodusobjektid, kultuuriobjektid jne) ja üleliigseid kustutada (Components). Samuti saame modifitseerida iga kaardikomponendi kihtide omadusi (Layers). Joonis 2.27: Komponendid ja kihid Suumime sisse Eesti alale. Kohandame olemasolevat stiili näiteks nii, et muudame põhivärvi (Base), veekogude (Water), administratiivpiiride (Administrative boundaries) ja kohanimede (Place labels) värvi Components -&gt; Colors -&gt; Manage colors, määra igale komponendile sobiv värv muudame riiginimede (Countries) fonti (mh läbivalt suurtäheliseks) ja suurust Components -&gt; Typography -&gt; Countries, vali sobiv suurus ja värv ning Text transform väärtuseks uppercase kustutame transpordisõlmede (Transit), huviväärsuste (Point of interest labels) ja looduslike objektide nimede (Natural features) kihi Components -&gt; Transit -&gt; Delete component teeme sama kihtidega Point of interest ja Natural features käsitleme teid-tänavaid ühtmoodi ning peidame kõikide teede ja tänavate (Road network) nimed Components -&gt; Road network -&gt; vali Simple -&gt; Labels, teeme valiku mitteaktiivseks muudame kõik teed-tänavad nähtavaks alles siis, kui sissesuumimise tase on vähemalt 13 Layers -&gt; Road network surface -&gt; Opacity -&gt; Override -&gt; Style across zoom range -&gt; määra Rate of change väärtuseks Step -&gt; Zoom 0 väärtuseks määra 0 (täiesti läbipaistev), Zoom 22 muuda Zoom 13ks ja määra sellele väärtus 1 (täiesti läbipaistmatu) peidame maismaa ja veekogude puhul (Land &amp; water) maakasutuse (landuse) ja maapinnakatte (landcover) andmed Components -&gt; Land &amp; water -&gt; Land -&gt; Simple jätame alles ainult riigipiirid, kaotame nende tagant halo, muudame piirjoone katkendjooneks, muudame selle paksust Components -&gt; Administrative boundaries, teeme mitteaktiivseks valikud Sate/province boundaries ja County/district boundaries, valime Country boundaries alt Dash pattern -&gt; Long dash Layers -&gt; Administrative boundaries admin -&gt; teeme nähtamatuks admin-0-boundary-bg admin-0-boundary -&gt; Width -&gt; Override, vali uus paksus eri suumimise astmetel peidame ära mandrite, osariikide ja maakondade ning asulasiseste alamjaotuste nimed. Muid kohanimesid näitame kohalikus keeles, riikide nimedel muudame taustahalo värvi Components -&gt; Place labels -&gt; Language -&gt; Local Components -&gt; Place labels, teeme mitteaktiivseks valikud Continents, States/provinces ja Settlement subdivisions Layers -&gt; Place labels place-labels -&gt; country-label -&gt; Halo color -&gt; Override -&gt; valime ainult ühe värvi kõikidele sissesuumimise tasemetele riigisisestest kohanimedest näitame ainult linnade (ja väikelinnade) nimesid teise värviga ja kaldkirjas, ilma taustahalo ja ikoonita alles siis, kui sissesuumimise tase on vähemalt 7. Components -&gt; Place labels -&gt; Settelements -&gt; Label style -&gt; Text only Layers -&gt; Place labels place-labels -&gt; settlement-minor-label, peidame kihi Layers -&gt; Place labels place-labels -&gt; settlement-major-label -&gt; Color -&gt; Override, määrame uue värvi Layers -&gt; Place labels place-labels -&gt; settlement-major-label -&gt; Font -&gt; Override -&gt; määrame mõne kaldkirjas fondi Layers -&gt; Place labels place-labels -&gt; settlement-major-label -&gt; Halo color -&gt; Override -&gt; määrame α väärtuseks 0 Selleks, et nüüd valida, mis üksusi kaardil mingi suumi tasemega kuvatakse, peame natuke muutma alusandmete filtreid. Alusandmetena kasutatakse vaikimisi Mapbox Streets v8 vektorkihtide tileset’i, kus on info kõikide nende objektide kohta, mida komponentidena lisada ja muuta saab. Selleks, et selle kihi andmetele ligi pääseda, peame valima Components -&gt; Place labels -&gt; Eject component -&gt; Eject 3 layers. Komponendi kihid muudetakse nüüd eraldiseisvateks kihtideks, mille andmeid saab ükshaaval muuta. Layers -&gt; settlement-major-label -&gt; Select data -&gt; Filter, kustutame kõik 3 olemasolevat filtreerimise tingimust (Edit -&gt; Delete condition). Loome uue tingimuse: Create filter -&gt; type, valime ainult väärtused city ja town Layers -&gt; settelement-major-label -&gt; Select data -&gt; Zoom extent, määrame Min väärtuseks 7 ja Max väärtuseks 22. See tähendab, et linnade nimesid hakatakse näitama alles siis, kui oleme sissesuumimise tase on vähemalt 7, ja nimesid näidatakse kuni viimase sissesuumimise tasemeni välja. Läheme andmete valimise juurest tagasi andmete stiliseerimise juurde (Style) Joonis 2.28: Stiliseeritud kaardipõhi Kui meil on tegelikult vaja ainult mingit väga üldist kaarti nt ainult administratiivpiiridega ja ilma igasuguste veeniredeta jms-ta, saame lisada eraldi Mapboxi riikide kihi Mapboxi vektorandmete lehelt. Selleks Layers -&gt; Source -&gt; None selected -&gt; Unused sources -&gt; Mapbox Countries v1 -&gt; Country boundaries liigutame riikide kihi kohanimede (Place labels) ja halduspiiride (Administrative boundaries) alla. värvime Eesti teist värvi: Layers -&gt; country-boundaries -&gt; Color -&gt; Style with data conditions -&gt; Choose a data field from -&gt; name_en -&gt; “Estonia”, vali sobiv värv. Teiste riikide ala (Fallback value ehk kõik, mis ei vasta tingimusele nimi == Estonia) võid muuta muud värvi. Joonis 2.29: Mapboxi riikide vektorkihi lisamine ja polügoonide värvimine tingimuse alusel 2.4.2.2 Oma andmete lisamine Nagu öeldud, lubab Mapbox visualiseerida ka enda andmeid. Selleks, et kujutada neid andmeid Mapboxis loodud aluskaardil, vali Layers -&gt; Add new layer -&gt; Source -&gt; Upload data, vali Moodle’ist alla laaditud fail vallakohtuprotokollid1.csv oota, kuni andmed on üles laaditud. Tasuta saab oma andmestikku ühes kuus üles laadida 20 korda. Kui andmed on üles laetud, vali Source alt kiht, mis algab tekstiga vallakohtuprotokollid1. Saad valida, millisena soovid andmekihti kuvada (nt punktidena, joontena, sümbolitena vm-na). Saki Style alt saad omakorda määrata, milline valitud objektitüüp täpselt välja näeb. Joonis 2.30: Mapboxi üles laaditud valdade punktid Kõiki elemente võib värvida ühtmoodi konkreetse väärtusega (nt kõik punktid olgu punased). Võimalik on aga kasutada värvi, läbipaistvust, suurust ka selleks, et väljendada mingit andmestiku atribuuti (= tunnust = tulpa). Värvime punktid esmalt näiteks selle järgi, millised vallad kuuluvad põhja- ja millised lõunaeesti murrete kõnelemispiirkonda (kvalitatiivne rühmitav atribuut), ning seejärel muudame punktide suurust selle järgi, kui palju oli valdade protokollides keskmiselt selliseid sõnu, mida tänapäeva kirjakeelel treenitud morfoloogiline analüsaator ära ei tundnud (kvantitatiivne atribuut). Layers -&gt; vallakohtuprotokollid1 -&gt; Color -&gt; Style with data conditions -&gt; data field on L/P. Määrame põhjaeestile ehk P-le näiteks mõne külmema tooni ja lõunaeestile ehk L-le mõne soojema tooni. Layers -&gt; vallakohtuprotokollid1 -&gt; Radius -&gt; Style across data range -&gt; data field on TundmatuteProtsent. Kõige väiksem protsent andmestikus on 7%, määrame sellele suuruseks näiteks 3 pikslit. Kõige suurem protsent on 52%, määrame selle suuruseks näiteks 12 pikslit. Kõik ülejäänud punktisuurused paigutatakse tundmatute analüüside protsendi järgi nende kahe vahele. Võime lisaks määrata veel ühe tingimuse, et punktide suurust hakataks eristama alles siis, kui sissesuumimise tase on näiteks 5, enne seda on kõik punktid 3 piksli suurused. Kuna osa punkte kattub, võiksime teha punkte pisut läbipaistvamaks. Selleks vali Layers -&gt; vallakohtuprotokollid1 -&gt; Opacity -&gt; määra väärtuseks näiteks 0.5, nii on punktid poole läbipaistvamad. Joonis 2.31: Lõuna- ja põhjaeestikeelsed protokollid ning tundmatute analüüside protsent Näeme nüüd, et lõunaeestikeelsete protokollidega on tänapäeva kirjakeelel treenitud keeleanalüsaatoril palju keerulisem hakkama saada kui põjaeestikeelsete protokollidega. Ometi on ka põhjaeestikeelsete protokollide hulgas kaks valda, milles oli oluliselt rohkem analüsaatorile tundmatuid sõnavorme. Milles asi? Püüame eristada valdu veel ühe kvalitatiivse tunnuse, normaliseerimise alusel. Selleks saaksime ühesuguste punktide asemel kasutada näiteks erinevaid sümboleid normaliseeritud ja normaliseerimata protokollide kohta. Kuna aga selle jaoks peaksime minema algusesse tagasi ning Select data alt valima punkti asemel sümbolid ja kogu senine töö protokollidega läheks kaotsi, eristame normaliseeritud ja normaliseerimata tekste punktide äärejoonte paksuse kaudu. Layers -&gt; vallakohtuprotokollid1 -&gt; Stroke width -&gt; Style width data conditions -&gt; Data field on Norm. Määrame normaliseeritud (J) protokollidele väärtuseks 0 ja normaliseerimata (E) protokollidele väärtuseks 1. Võime muuta ka piirjoone värvi, kui muudame Stroke Color väärtust. Joonis 2.32: Normaliseeritud ja normaliseerimata tekstid Nüüd näeme, et lisaks lõuna- ja põhjaeesti keelele mängib analüsaatori jaoks olulist rolli ka see, kas teksti on püütud sisestamisel tänapäeva kirjakeelele lähendada või mitte. Lõpetuseks võiksime näidata sisse suumides ka valdade nimesid. Selleks peame lisama teise samasuguse vallakohtuprotokollide kihi, ent punktide asemel valima nüüd sümbolid ja sümbolite alt teksti, mille abil kuvada tunnust Vald. Joonis 2.33: Valdade nimed eraldi kihil Kihtide järjekorda muutes saame kontrollida, mida meie kaardilt näha on (näiteks võib riigipiiride kihi tõsta kohanimede kihist ettepoole, kui ei taha, et sisse suumides ilmuksid nähtavale linnade nimed). Kahjuks ei võimalda Mapbox Studio praegusel hetkel lisada kaardile legendi jms kaardi elemente. Mapbox Studio võimaluste kohta võid põhjalikumalt lugeda sellest juhendist. 2.4.2.3 Kaardi jagamine Loodud kaarti saame printida/faili salvestada või eksportida kuskile veebikeskkonda. Kaardi eksportimiseks ja selle kasutamiseks nt mõnes muus veebikeskkonnas aluskaardina, vali ülevalt menüüst Share. Preview only linki jagades saab kes tahes lingiga sinu kaarti vaadata. Mujal keskkondades kasutamiseks või stiili jagamiseks teiste Mapboxi kasutajatega tuleb loodud stiil esmalt teha avalikuks: Allow copying: Make public. Website embed annab iframe’i koodi, mille saab kleepida mis tahes veebilehe HTML-koodi sisse, et kaart ilmuks mingil veebilehel. Developer resources lubab kaardistiili kasutada muudes veebi- või telefonirakendustes. Näiteks Web saki alt leiab stiili aadressi (Style URL) ja juurdepääsuloa (Access token), mille abil on võimalik kasutada Mapboxis loodud stiili mõnes veebirakenduses (nt StoryMapJS). Saki Third party alt leiad aadressi, millega saab kasutada loodud stiili suuremate GIS-tarkvarade rakendustes (ArcGIS, Carto, QGIS). Sellest järgmisel korral veel. Joonis 2.34: Kaardistiili jagamine "],["storymaps.html", "Praktikum 3 Story maps 3.1 Story maps 3.2 Ülesanne: tänane kuupäev story map’is", " Praktikum 3 Story maps 3.1 Story maps Story map, mida on eesti keelde tõlgitud kui kaardilugu, on formaat, mis võimaldab piltide, teksti, video ja kohainfo kaudu jutustada lugusid fotograafiast, kunstist, kirjandusest, spordist, ajaloost, teadusest ja paljust muust. Kontseptsioon on lihtne: kaardile märgitakse punktid, mille juurde saab lisada nii tekstilist kui ka pildilist infot selles kohas toimunud sündmuse või selles kohas paikneva objekti kohta. Kaardi punkte omavahel ühendades tekibki mingi narratiiv. Laiemas tõlgenduses ei pea kaardiloo kaart olema tingimata geograafiline. Kontekstina võib toimida ka näiteks mõni maal, foto või muu visuaal, ent taust on sel juhul siiski käsitletav ruumina, milles saab loogiliselt liikuda. Klassikalises kaardiloos on lähtepunktiks siiski mingi narratiiv, mida mööda liikudes liigume ka vastavatesse paikadesse geograafilisel kaardil. Ühest küljest on kaardilool palju ühist tavaliste veebilehtedega, kus jutustatakse mingit lugu, mida illustreerivad muu materjali kõrval ka kaardid, ent kaardilool on koht (ja aeg) oluliselt prominentsemal kohal. Teiselt poolt on kaardilool ühisjooni tavaliste kaardirakendustega, kuhu saab lisada ruumiobjekte, mida iseloomustavad teatud atribuudid. Atribuudina võib näiteks lisada ka pikema teksti, lingi pildile või videole jpm. Väga selget piiri kaardiloo ja kindlasti-mitte-kaardiloo vahele on raske tõmmata, ent kuna kaardiloo fookus on selgelt mingi loo jutustamisel või argumendi esitamisel, on see enamasti visuaalselt esteetilisem ja sujuvam ning oluliseks omaduseks on väljundi võimalikult lihtne ja kiire integreeritavus erinevate veebiplatvormidega. Kaardilugu on hea meedium näiteks esitluste ja ettekannete jaoks, kui aeg ja koht (õigemini kohad) on narratiivi või argumendi esitamise seisukohast olulised. Kõige rohkemate funktsioonide ja võimalustega teenust kaardilugude tegemiseks pakub ilmselt ESRI oma ArcGIS StoryMaps rakenduse kaudu. ESRI-l on ka eraldi digihumanitaaria story map’ide kollektsioon. Mõned näited: Kaardilugusid on üha enam hakatud tegema ka Eestis, vaata näiteks Keskkonnaagentuuri, statistikaameti kaardilugusid. Ka 2023. aasta konkursil “Andmepärl” parima infograafika tiitliga pärjatud Eesti Ekspressi lugu Tallinna elanike kohta on oma olemuselt kaardilugu. Samamoodi sama konkursi 2024. aasta parim andmelugu “Metsa- ja põllumuldade seire” (Keskkonnaagentuur). Vaata konkursi töid siit. Sel korral vaatleme esmalt vabavaralist platvormi StoryMapJS ning võrdleme seda seejärel ESRI platvormi tasuta funktsioonidega. 3.1.1 StoryMapJS Loo tegemiseks pead Google’i kasutajakontoga sisse logima. Kui oled sisse loginud, loo uus kaardilugu (kui varasemaid kaardilugusid pole, suunatakse sind otse loo nimetamise juurde. Kui oled keskkonnas ka varem midagi teinud, vali New). Nimeta oma lugu. Loo nimi saab ühtlasi sinu projekti ID-ks, mida kasutatakse hiljem loole viitava lingi nimes. Kui kasutad mitmesõnalist nime, milles tühikud eraldavad sõnu, siis asendatakse need ID-s sidekriipsudega. Sätete (Options) alt saad valida: kaardi suuruse (kõrgus (Height) pikslites, laius (Width) protsentides ekraani laiusest); keele. Keel määrab ära, mis keeles kuvatakse kaardiloo vaatajale igasugu nupud ja juhised. Valikus on ka eesti keel; teksti fondi (küsimärgile vajutades näed ka, millised eri variandid välja näevad); kas soovid, et kaardi erinevate punktide vahele tõmmataks joon (treat as cartography) või mitte (treat as image); esilehel kuvatava nupu nt vaatama kutsuva tekstiga (call to action); aluskaardi. Saad valida nii olemasolevate põhjade vahel kui ka omaenda või teiste kohandatud kaartide vahel. Näiteks on võimalik integreerida Mapboxi kaarte, kui kopeerid sinna Mapboxi stiili veebiaadressi ja juurdepääsuloa (vt eelmise korra materjale). Joonis 3.1: Storymaps JS sätted Kui oled oma loo n-ö ära seadistanud, siis saad hakata lisama sisu. Kõigepealt saad valida pildi, mida avalehel näidatakse (Media), lisada pealkirja ja tutvustava teksti ja muuta soovi korral tausta (Background Options). Joonis 3.2: Storymaps JS avakuva seadistamine Preview vahelehel näidatakse story map’i väljundit, lehe vasakul poolel hakatakse kuvama loo kaarti, kui mingid kohad on juba ära märgitud. Sisu lisamiseks lisa slaid (Add slide). Iga slaid on seotud ühe kohaga. Esmalt otsi koordinaatide või kohanime järgi koht, millega slaidil esitatav loo osa seotud on. Saad vahetada koha markerit ka mõne enda üles laetud pildi/ikooni vastu (Marker Options). Võid lisada nii pilte kui ka videoid, samuti saab teksti sisse lisada linke. Kui oled loo valmis saanud, siis salvesta see (vasakul ülemises menüüs nupp Save). Oma lugu võib jagada (paremal ülemises menüüs nupp Share) lingiga või ka näiteks otse Twitteri, Facebooki, Google+’i või Redditi kaudu. Samuti võib selle iframe’i koodi abil lisada otse enda veebilehele (näiteks Wordpressi, Mediumi või mujale, kasvõi sellele kursuse lehele siin). Joonis 3.3: Storymaps JS väljundi kuvamine iframe’i kaudu (väga lihtsal) veebilehel 3.1.2 ArcGIS StoryMaps Loo tegemiseks pead looma (avaliku) kasutajakonto. Seejärel saad meilile aktiveerimislingi ning sellele vajutades saabki konto loomise lõpule viia (määrata kasutajanime ja parooli jms). Kindluse mõttes võib esmalt ära vahetada vaikimisi platvormi keele, kui see ei ole inglise keel. Vastasel juhul võivad mõned tõlked arusaamatuks jääda (nt sõna heading tõlkena võib kohata sõna suund). Selleks saab minna üleval paremas nurgas enda profiili lingile ning vaadata lähemalt seadeid (Kuva minu seaded või View my settings) ning uuenda keelt, numbri- ja kuupäevavorminguid. Seejärel trüki aadressiribale uuesti https://storymaps.arcgis.com. Uue loo tegemiseks vajuta nupul Create story. Võib alustada tühja malliga (Start from scratch) või valida mallitüübi Sidecar (tekst ja visuaal kuvatud kõrvuti paneelidel, sobib hästi, kui suurem rõhk on näiteks tekstil ning pildid ja kaardid on lihtsalt visuaalne lisamaterjal) Guided map tour (tekst ja visuaal kuvatud kaardil, vaataja liigub mööda punkte kindlaks määratud järjekorras) Explorer map tour (nagu eelmine vormel, aga vaataja saab valida, mis järjekorras mööda punkte liigub; tekst ja kaart eraldi paneelidel). Kasutame siin tühja malli, millele saame lisada teisi malle juurde. Tiitellehele saab märkida oma projekti nime ja lühikese tutvustuse. Võib lisada juurde ka pildi või video (NB! Kui kasutad teiste tehtud materjale, viita kindlasti ka autorile). Joonis 3.4: ArcGIS StoryMapsi avakuva Plussikestest saad lisada uusi plokke: teksti (Text), nupu, mis viib nt mingile lingile (Button), horisontaalse eraldusriba eri tekstiplokkide vahele (Separator), koodiploki (Code), kaardi (Map), graafikuid (Chart), infograafikat (Infographic), tabeli (Table) kuni 8 tulba ja 13 reaga, pildi (Image), 360-kraadise pildi (360 image), pildigalerii (Image gallery), video (Video), heli (Audio), olemasoleva ArcGISi rakenduse (ArcGIS app), ajajoone (Timeline), liuguri, mis lubab kõrvutada kaht kaarti või pilti (Swipe), teisi loomalle (Sidecar, Map tour), mille sisse omakorda võib lisada üleval nimetatud elemente. Tasulises versioonis on võimalik kasutada veel plokitüüpe. Kaardi (Map) võid lisada juba varem valmis tehtud kaartide hulgast (nt vallakohtuprotokollide kaardi) või teha kohapeal uue (New express map). Selleks tuleks valida esmalt aluskaart (basemap), seejärel lisada tekst, meedia ja siduda punktid konkreetsete kohtadega. Joonis 3.5: ArcGIS StoryMapsi kaardi lisamine (NB! uusimas versioonis võib tekstide ja ikoonide järjestus olla pisut teistsugune) Joonis 3.6: Joonistamise võimalused kaardi tegemisel Võid aluskaardina kasutada ka Mapboxis stiliseeritud kaarti. Joonis 3.7: Mapboxi kaardi kasutamine aluskaardina Saad kaardi lisada ka Map tour formaadis. Joonis 3.8: ArcGIS StoryMapsi kaardi lisamine Map tour formaadis Kui lugu on valmis, avalikusta lugu (ülemises menüüs nupp Publish). Kaarti saab jagada samuti lingiga (kui lugu on avalik), QR-koodiga jmt. Põhimõtteliselt peaks olema võimalik lisada kaardilugu iframe’i koodiga ka teistele veebilehtedele (More actions -&gt; Embed this story), ent igal pool ei pruugi see õnnestuda. Vaata lähemalt kõikide ArcGIS-i story map’ide võimalusi siit. 3.2 Ülesanne: tänane kuupäev story map’is Otsi Vikipeediast tänase kuupäevaga seotud sündmus (nt ajalooline sündmus, mõne kuulsa isiku sünni- või surmakuupäev), võid kasutada ka eestikeelset nimekirja, ning kujuta vastavat Vikipeedia artiklit või selle olulisemaid osi story map’il kas StoryMap JS või ArcGis Story Maps keskkonnas. Lisa võimalusel pilte, linke ja muud, mis loo käiku aitavad jälgida. Avalikusta valmis story map ning lisa Moodle’is kaardilugude andmebaasi kaardiloo pealkiri, link, iframe’i kood ning kuvatõmmis. "],["qgis.html", "Praktikum 4 Sissejuhatus QGISi 4.1 Installimine ja seadistamine 4.2 Aluskaardid 4.3 Andmete avamine 4.4 Andmete visualiseerimine 4.5 Kaartide eksportimine", " Praktikum 4 Sissejuhatus QGISi QGIS (varasemalt Quantum GIS) on vabavaraline ja avatud lähtekoodiga geoinfosüsteemide tarkvara, mida saab kasutada kõikide tuntumate operatsioonisüsteemidega. QGISis saab rakendada kõiki põhilisi ruumiandmete analüüsi meetodeid ning funktsionaalsuselt ei jää see sugugi alla kommertstarkvarale (nt ArcGIS). 4.1 Installimine ja seadistamine QGISil on alati kaks hetkeversiooni: stabiilne Long Term Release (LTR) ja uusimate võimaluste Latest Release (LR), lisaks on mõlemast vaheversioonid (Point Release), milles parandatakse ainult varasema versiooni vigu, aga ei muudeta midagi muud (nt ei lisata uusi tööriistu). Väga suuri erinevusi LTR ja LR vahel ei ole, eriti selle kursuse raames käsitletavate tööriistade osas. Arvutiklassi arvutitesse peaks olema installitud kõige hiljutisem stabiilne versioon 3.40 ‘Bratislava’. Kel huvi, võib vaadata lähemalt ka väljalaskegraafikut. QGISi saab alla laadida programmi ametlikult kodulehelt, valides enda arvuti operatsioonisüsteemile sobiva variandi. Allalaadimine võib pisut aega võtta. Kui allalaadimine on lõppenud, avame faili ning installime programmi. Kasutame vaikimisi valikuid. Avame programmi QGIS Desktop. 4.1.1 Kasutajaliidese keel Sageli on QGIS esimesel korral avades eestikeelne. See on küll tore, aga kahjuks on tõlge kohati poolik ning internetist abi otsides on eestikeelsetest siltidest ja terminitest vähe kasu. Niisiis kasutame kursusel ingliskeelset versiooni. Selleks saab valida ülaserva menüüst Seaded → Suvandid → Üldine ning teha linnuke valiku Override System Locale ette. Vahetame ainult kasutajaliidese keele (User interface translation) ning vajutame allservas OK. Sulgeme QGISi ja avame uuesti. Nüüd ongi programm ingliskeelne. Joonis 4.1: Kasutajaliidese keele seadistamine QGISis 4.1.2 Vaikimisi koordinaatide referentssüsteem Kuna enamik harjutusi kursusel käsitlevad Eesti ruumiandmeid, oleks mõistlik valida vaikimisi koordinaatide referentssüsteemiks (CRS) Eesti süsteemi. Valime menüü ülaservast Settings → Options → CRS and Transforms → CRS Handling → CRS for Projects → Use a default CRS. Klikime rippmenüü kõrval ikoonil ja otsime süsteemi Estonian Coordinate System of 1997 ehk L-EST97, mille EPSG kood on EPSG:3301. Valime sama referentssüsteemi ka CRS for Layers valiku juures. Vahetame ära ka praeguse projekti CRSi. Selleks klikime ekraani alumises paremas nurgas maakera ikooni kõrval ning valime seal EPSG:3301 koodiga CRSi. Joonis 4.2: Koordinaatide referentssüsteemi vahetamine QGISis 4.1.3 Paneelid ja tööriistad Vaikimisi nähaolevaid paneele ja tööriistu saab muuta, valides vastavalt View → Panels ja View → Toolbars. Soovitatav on vaikmisi mitte näidata brauseri paneeli (Browser), kuna see võib QGISi muuta mingites operatsioonisüsteemides aeglaseks ning programmi hakata kokku jooksutama. Loome enda arvutisse kursuse kausta (nt nimega geohum_2025) ning salvestame sinna QGISi (hetkel ilma sisuta) projekti: ülamenüüst Project → Save. Praktikumi jooksul võiks projekti aeg-ajalt salvestada! Vaatame QGISi kasutajaliidest. Suurde keskel olevasse aknasse ilmuvad kaardid ja ruumiandmete kihid graafiliselt. Vasakul on kihtide aken Layers. Allservas näeme kursori asukoha koordinaate, mõõtkava, mida saab seal ka muuta, ning paremal nurgas on koordinaatide referentssüsteem, mis peaks nüüd olema EPSG:3301. Ülemises servas on menüüd ja kõiksugu tööriistad. 4.2 Aluskaardid Nagu varasemates praktikumides nägime, on olemas rohkelt aluskaarte, mida erinevates rakendustes põhiliselt teemakaartide tegemisel kasutatakse. QGISis saab neid kasutada näiteks WMS-, WFS- või WCS-teenuste (vastavalt web map service, web feature service ja web coverage service) või pistikprogrammide (plugins) kaudu. Eesti aluskaartide jaoks saab WMS-teenuse kaudu kasutada peaaegu kõiki Maa-ameti XGISi kaardirakenduses olevaid kihte. Täpsemalt saab lugeda Maa-ameti WMS-teenuste lehelt. Lisaks saab luua WMS-teenuse kaudu ühenduse kõiksugu muude ruumiandmete serveritega üle maailma (vt nt terrestris või otsi üles eri riikide ametlike geoportaalide teenused). Erinevalt WFS-teenusest (vektorandmete jaoks) ja WCS-teenusest (rasterandmete jaoks), saab WMS-teenuse kaarte kasutada sisuliselt ainult aluskaartide jaoks ja visualiseerimiseks. Päringuid, valikuid jm toiminguid nendega teha ei saa, kuna tegemist on lihtsalt piltidega. WMS-teenusest aluskaardi lisamiseks valime menüüst Layer → Add Layer → Add WMS/WMTS layer. Lisame uue ühenduse (New). Avanenud aknas määrame ühenduse nimeks (Name) näiteks Maa-ameti aluskaart ning URLi juurde kopeerime aadressi https://kaart.maaamet.ee/wms/alus?. Vajutame OK. Nüüd on paika pandud, millise Maa-ameti kaardiserveriga QGIS ühenduse loob, aga ühendust ennast ei ole veel tekkinud. Klikime ühenduse loomiseks nupul Connect. Valime serverist laetud kihtide hulgast näiteks 138 MAANTEED ning klikime nupul Add. Lisame veel ühe ühenduse (New). Seal kirjutame nime lahtrisse Maa-ameti fotokaart ning URLi juurde kopeerime aadressi https://kaart.maaamet.ee/wms/fotokaart?. Vajutame OK. Klikime uue ühenduse loomiseks nupul Connect. Valime serverist kihi 6 vreljeef ning klikime nupul Add. Sulgeme akna. Sikutame Layers paneelil teede kihi värvilise reljeefvarjutuse kihi peale, vastasel juhul ei ole teid näha. Joonis 4.3: WMS-teenuse aluskaart QGISis Kui teeme nüüd näiteks värvilise reljeefvarjutuse kihil paremkliki ja valime Properties, saame vaadata kihi omadusi. Ühtlasi näeme, et visuaalselt saame kihti teha ainult läbipaistva(ma)ks (jaotis Transparency), mustvalgeks, kontrastsemaks, heledamaks jms (jaotis Symbology), nii nagu ka tavalise pildifaili puhul. Saame aluskaarte kasutada ka pistikprogrammide kaudu (nt QuickMapServices, aga vt ka teisi aluskaartide pistikprogramme). Valime ülaservas menüüst Plugins → Manage and Install Plugins. Otsingusse kirjutame Quickmap, valime leitud pistikprogrammi QuickMapServices ning installime selle. Sulgeme akna. Järgmiseks valime ülamenüüst Web → QuickMapServices ning sealt mõne teenusepakkuja aluskaardi. Esimest korda pistikprogrammi kasutades võiks laadida ka suuremat aluskaartide valikut pakkuva lisapaketi Web → QuickMapServices → Settings → More services → Get contributed pack. Võid nüüd vasakul paneelil kihte sisse ja välja lülitada või ära kustutada. Suumi ka veidi Eesti alalt välja ning vaata, milline näeb välja ülejäänud maailm Eesti projektsiooni kasutades. Joonis 4.4: ESRI aluskaart QGISis 4.3 Andmete avamine Nagu varasemast mäletame, on põhilised ruumiandmete tüübid raster- ja vektorandmed. Viimased neist võivad koosneda punktidest, joontest või polügoonidest. Vektorandmed võivad lisaks olla spetsiaalses ruumiandmete vormingus (nt GeoJSON, SHP, KML, GPKG) või ka tavalises lihttekstiformaadis (nt CSV). 4.3.1 Rasterandmed Rasterandmete sisselugemiseks kasutame näitena Maa-ameti ortofotosid aastatest 1995 ja 2023. Valime ülamenüüst Layer → Add Layer → Add Raster Layer ning seejärel valime failid orto_1995.tif ja orto_2023.tif. Vajutame Add ja Close. Esmapilgul ei ole midagi näha, kuna ortofotod on väga suure mõõtkavaga (= väga väikese ala kohta). Teeme ühel fotokihtidest paremkliki ning valime Zoom to Layer(s). Joonis 4.5: Maa-ameti ortofotod QGISis Vaatame fotode erinevusi. Selleks lülitame vastavaid kihte Layers paneelil sisse ja välja. Proovime suumida ka lähedale, et näha eraldiseisvaid piksleid. 1995. aasta ortofotol on oluliselt vähem piksleid, mis tähendab, et ühe piksli mõõtmed on palju suuremad. Rastri pikslisuuruse vaatamiseks teeme rasterkihil paremkliki ning valime Properties → Information → Information from provider → Pixel size. Piksli küljepikkus on siin esitatud meetrites. Kustutame ortofotod nüüd QGISi kihtide hulgast ära (paremklikk kihil ja Remove Layer). Ortofotode kohta saab rohkem lugeda ja neid ka ise kaardiruutude kaupa alla laadida Maa-ameti Geoportaalist. 4.3.2 Vektorandmed Vektorandmete avamise näitlikustamiseks kasutame kohapärimuse kaardirakenduse (Eesti Kirjandusmuuseum, Maa-amet, Keskkonnaamet) andmeid. Rakendusest on päritud kõiki tekste, helisalvestisi ja videoid, milles mainitud koha tüüp oleks jõgi. Kohapärimuse vektorikihi ruumiobjekti tüüp on punkt, failivorming on GeoJSON. Lisaks loeme sisse Maa-ameti vooluveekogude andmed, ent vaid nende jõgede kohta, mida on kohapärimuse kihil mainitud. Vooluveekogude vektorkihi ruumiobjekti tüüp on joon, failivorming on GPKG (geopackage). Kõige taustaks loeme sisse ka Maa-ameti ajalooliste kihelkonnapiiride andmestiku (polügoonid). Failivorming on SHP (shapefile). Vektorandmete sisselugemiseks valime ülamenüüst Layer → Add Layer → Add Vector Layer, valime Source jaotises kolme punktikesega nupul vajutades sobiva faili ja vajutame nupul Add. Kui GeoJSON- ja GPKG-vormingus faile saame lugeda sisse tervikuna, siis SHP-vormingus faili puhul peame sisse lugema ainult SHP-faili enda, ent hoolitsema selle eest, et kõik ülejäänud failid (cpg, dbf, prj, sbn jne) oleksid sellega samas kaustas olemas! Vastasel juhul SHP ei tööta. Seda peab silmas pidama ka siis, kui enda andmestikku SHP-vormingus kellegagi jagada tahate. Joonis 4.6: Kohapärimuse, jõgede ja kihelkondade vektorkihid QGISis Jällegi saab kihtide (Layers) paneelil kihtide järjekorda muuta, kui mõnd kihti näha ei ole (näiteks polügoonid katavad ära nii punktid kui ka jooned). 4.3.2.1 Atribuuttabel Vektorkihtide (aga vahel ka rasterkihtide) atribuuttabeleid saame vaadata, kui teeme kihil paremkliki ja valime Open Attribute Table. Atribuuttabel avaneb ka siis, kui teha kiht aktiivseks ning vajutada klahvi F6. Joonis 4.7: Jõgede vektorkihi atribuuttabel 4.3.3 Andmete sisselugemine CSV-failist Vektorkihi võime sisse lugeda ka tavalisest, väljadega tekstifailist (delimited text). Selleks valime Layer → Add Layer → Add Delimited Text Layer. Valime andmestike hulgast varasemast tuttava vallakohtuprotokollide csv-faili. Väljadega faili sisselugemiseks tuleb määrata, milline sümbol välju/tulpasid eraldab, millises kodeeringus fail on, kas failil on ka päiserida tulbanimedega jm. Kui tahame, et tabeli vaatlused kuvataks kuidagi ka kaardil, tuleb ette anda ka tulbanimed, mis sisaldavad koordinaate, ning koordinaatide referentssüsteemi. Vastasel juhul (No geometry) loetakse sisse lihtsalt atribuuttabel, ent tabeli andmeid ei saa kaardil ilma neid mingite ruumiandmetega ühendamata kuvada. Vallakohtuprotokollide faili kodeering on UTF-8, väljasid eraldab semikoolon, esimene rida on päiserida, koordinaadid on tulbas nimega Longitude ja Latitude, koordinaadid on WGS-84 süsteemis (nn geograafilised koordinaadid), EPSG koodiga 4326. Joonis 4.8: Vallakohtuprotokollide csv-faili sisselugemine Vaatame nüüd ka vallakohtuprotokollide atribuuttabelit. 4.4 Andmete visualiseerimine Vektorkihi visualiseerimiseks võime teha valitud kihil topeltkliki (või paremkliki ja valida Properties) ning liikuda jaotisse Symbology. Võime kujundamise paneeli ka püsivalt QGISi projekti põhiaknas kuvada, kui valime projektiakna ülamenüüst View → Panels → Layer Styling. Vaikimisi on kõik kihi elemendid kujundatud samamoodi (Single Symbol). Punktobjektide põhiline kujunduselement on kasutatav sümbol (Marker), joonobjektidel joon (Line) ja polügoonidel polügooni täitevärv või -muster (Fill). Kiireks muutmiseks on kohe nähtaval näiteks värv (Color), läbipaistvus (Opacity), suurus (Size või Width) ja mõned vaikimisi pakutud sümbolitüübid või täitemustrid. Kui tahame vektorkihi elementide väljanägemist põhjalikumalt muuta, saame klikkida vastava kujunduselemendi (Marker, Line, Fill) all asuval tekstil (Simple Marker, Simple Line, Simple Fill). 4.4.1 Harjutus 1 Jätame kihelkondade polügoonidest alles ainult piirjooned (Outline: Simple Line), mille värvime omakorda helehalliks. Teeme jõgede jooned siniseks (Color) ja paksemaks (Width). Võime lisada sinistele joontele taustaks ka teise, veidi paksema ja heledama joone, mis toimiks visuaalse puhvrina (Add symbol layer). Teeme kohapärimuse punktid suuremaks (Size) ja läbipaistvamaks (Opacity), teeme piirjoone (Stroke) heledamaks. Joonis 4.9: Muudetud kujundusega vektorkihid 4.4.2 Sildid Lisame jõgede kihile ka sildid tulbast nimetus. Selleks teeme jälle valitud kihil topeltkliki ja liigume nüüd jaotisse Labels. Vaikeväärtuse No Labels asemel valime Single Labels ning Value lahtrisse valime tulba/tunnuse nime. Text → Size jaotises teeme teksti pisut väiksemaks. Formatting → Spacing → letter määrame väärtuseks 1, et tähtede paigutust hõrendada. Lisame tekstile puhvri Buffer → Draw text buffer. Placement jaotisest valime General Settings → Mode → Curved, et paigutada sildid jõgede kõveruse järgi. Lubame neid paigutada nii joonest vasakule ja paremale kui ka joone peale. Rendering jaotisest valime Overlapping labels → Allow Overlaps without Penalty, et näidata kõiki silte. Label options → Allow inferior fallback placements lubab silte paigutada ka horisontaalselt, kui joon on muidu liiga lühike, et tekst sellele ära mahuks. Callouts → Draw callouts lubame silte ka kaugemale paigutada, tõmmates sildi ja objekti vahele joone. Tööriistaribal saab siltide tööriistadega silte ka ükshaaval paigutada, keerata jne. Joonis 4.10: Siltide tööriistad Joonis 4.11: Siltidega vektorkiht 4.4.3 Harjutus 2 Lisa WFS-teenuse (mitte WMS!!!) kaudu Maa-ameti ajalooliste haldusüksuste seast (https://teenus.maaamet.ee/ows/wms-ajalooline-haldus?) 1922. aasta vallapiiride kiht. Vallapiiride kihile lisa vallakohtuprotokollide punktid. Püüa kujundada kaart vallapiiride ja protokollidega nii nagu etteantud joonisel. Valdade kihile tekstuuri lisamiseks saad Simple Fill kujunduselementide juures valida Fill style → Solid asemel midagi muud. Protokollikihi markerite puhul kombineeri selleks variante Simple Marker (taustaruuduke) ja SVG Marker (kaalude ikoon). Taustaruudukesele saad varjusid lisada, kui valid markeri, kerid kujundusvalikute lõppu, teed linnukese valiku Draw effects ette ning valid tähekesest valiku Drop Shadow. Joonis 4.12: Vallakohtuprotokollide kaart Lahenduskäik (üks võimalikest): Lisame WFS-teenuse kaudu valdade aluskaardi: Layer → Add Layer → Add WFS / OGC API - Features Layer. Loome uue ühenduse (New), ühenduse nimeks paneme näiteks Maa-ameti ajalooline haldus, URL-ribale kleebime aadressi https://teenus.maaamet.ee/ows/wms-ajalooline-haldus?. Vajutame OK. Loome kaardiserveriga ühenduse (Connect) ning valime pakutud kihtide hulgast kihi Vald 1922 (ms:vallad_1922). Vajutame Add, avanenud hüpikaknas vajutame Add Layers ning sulgeme andmete sisselugemise akna. Kui QGISi sisseloetud kihtide hulgas pole veel vallakohtute punktikihti, avame ka selle (vt jaotist Andmete sisselugemine CSV-failist). Teeme valdade polügoonikihil (ms:vallad_1922) topeltkliki ning liigume jaotisse Symbology. Fill → Simple Fill all valime Fill color väärtuseks kollase värvi HEX/HTML-koodiga #d6bf15, Fill style väärtuseks Dense 1, piirjoonte paksuseks 0,1 mm (Stroke width), piirjoonte värviks tumesinise värvi HEX/HTML-koodiga #1d5060 (Stroke color). Teeme topeltkliki vallakohtuprotokollide punktikihil ja liigume samuti jaotisse Symbology. Marker → Simple Marker all valime Symbol layer type väärtuseks SVG Marker, suuruseks (Size) 6 mm, SVG browser aknast valime App Symbols → amenity ning valime kaalu ikooni. Nüüd lisame kaalu ikoonidele alla veel oranžid kastikesed, klikkides Marker → SVG Marker kastikese kõrval rohelisel plussmärgil (Add symbol layer). Tekkinud punktisümboli (Simple Marker) liigutame SVG markeri alla, kasutades sinist noolt kastikese kõrval (Move down). Simple Marker sümboli suuruseks määrame 6,4 mm (Size), värviks (Fill color) oranži HEX/HTML-koodiga #f29b31, piirjoone värviks (Stroke color) pruuni värvi, nt HEX/HTML-koodiga #7d642a. Oranžile kastikesele lisame ka varju. Selleks kerime Simple Marker kujundusvalikute all lõppu välja, teeme linnukese valiku Draw effects ette ning klikime kollasel tähekesel. Lisaks valikule Source teeme linnukese ka valiku Drop Shadow ette. Lõpuks lisame valdadele valla nimedega sildid. Selleks teeme vallakohtuprotokollide punktikihil topeltkliki ja liigume jaotisse Labels. No Labels asemel valime Single Labels ning Value väärtuseks tulba Vald. Teksti suuruseks (Text → Size) määrame 8 punkti, joonistame siltidele kollase tausta (Background → Draw background) HEX/HTML-värvikoodiga #dacd81, taustapuhvri suuruseks määrame igast küljest 1 punkti (Size X ja Size Y), paigutame sildid sümbolite kohale (Placement → General Settings → Mode → Offset from Point, Quadrant üleval keskel, Offset Y: -3,5), lubame siltidel ka kattuda (Rendering → Overlapping labels → Mode → Allow Overlaps without Penalty), kattuvate siltide paremaks paigutamiseks lubame ka viiktekste (Callouts → Draw callouts), viiktekstide jooned teeme pruunikaks (HEX/HTML-kood #655629) ja paksemaks (0,5 mm), joone alguspunkti liigutame sümbolist kaugemale (Offset from feature väärtuseks nt 4 mm). Lõpuks kasutame siltide käsitsi liigutamise tööriista (kollane silt abc, mille all on sinisel taustal valge nool), et liigutada sildid sobivasse kohta. 4.5 Kaartide eksportimine Kui kaardiaknas on kaart valmis, siis võib selle salvestada pildina. Selleks: valime ülamenüüst Project → New Print Layout ja anname oma kaardile sobiva nime; avanenud aknas valime ülalt Add Item → Add Map. Joonistame akna valgele lehele nelinurga, hoides all hiire vasakpoolset klahvi. QGISi peaaknas olev kaart kuvatakse sinna. Abiks kaardi paigutamisel on taustaruudustik (View → Show Grid) ja selle külge haakimine (View → Snap to grid). Sätime kaarti nii, et kõik vajalik oleks näha. Selleks valime Edit → Move Content või vajutame klaviatuuril klahvi C. Kui oleme kaardi õigesse kohta liigutanud, valime menüüst Edit → Select/Move Item või vajutame klaviatuuril klahvi V. Muudame kaardi taustavärvi tumesiniseks. Selleks valime parempoolsel paneelil Item Properties ning kerime alla sektsioonini Background. Vahetame värvi. Lisame kaardile joonmõõtkava: Add Item → Add Scale Bar. Parempoolsel paneelil saab muuta mõõtkava pikkust ja stiili (Item Properties → Segments). Lisame paremale poole nii palju ühikuid, kui soovime. Fixed width muudab mõõtkava ühe ühiku pikkust. Lisame kaardile ka pealkirja ja viite Maa-ametile: Add Item → Add Label. Salvestame kaardivaate ning ekspordime seejärel kaardi: Layout → Export As Image. Joonis 4.13: Valmis kaart "],["avaandmed.html", "Praktikum 5 Avaandmed ja repositooriumid. Andmekihtide ühendamine 5.1 Avaandmed 5.2 Eesti ruumiandmed 5.3 Muude riikide ruumiandmed 5.4 Andmestike ühendamine", " Praktikum 5 Avaandmed ja repositooriumid. Andmekihtide ühendamine 5.1 Avaandmed Avaandmed (Open Data) on vabalt ja avalikult kättesaadavad andmed. Avaandmeid võib ilma piiranguteta alla laadida, kasutada ja levitada, juhul kui andmeid kasutatakse vastavalt litsentsitingimustele. Avaandmete mõiste on selgelt defineerituna kasutusel olnud kümmekond aastat ning on eriti viimastel aastatel tihedalt seotud survega avalikule sektorile teha oma andmed või osa nendest juurdepääsupiiranguta kättesaadavaks. Joonis 5.1: Avaandmete liike (Open Knowledge Foundation) Avaandmetele lähedane mõiste, mis on eeskätt kasutuses teadusandmete kontekstis, on FAIR-andmed ehk andmed, mis on leitavad (findable), kättesaadavad (accessible), ristkasutatavad (interoperable) ja taaskasutatavad (reusable). FAIR-andmed ei ole tingimata kättesaadavad kõikidele ja mis tahes tingimustel, ent järgivad andmete kvaliteedi tagamise põhimõtteid, on paremini dokumenteeritud ning hõlpsamini taaskasutatavad. Joonis 5.2: FAIR põhimõtted Andmete leitavusele aitab näiteks kaasa see, kui andmed on masinloetaval kujul, nad on kirjeldatud metainfo kaudu, varustatud märksõnadega ja neil on püsiidentifikaator DOI (Digital Object Identifier). Kui andmeid (või osa nendest) hoitakse mingis avalikus repositooriumis ehk elektroonilises andmehoidlas, kust neid on võimalik alla laadida, on need hästi kättesaadavad. Kui andmete vorming vastab mingitele kokkulepitud standarditele või andmeid hoitakse lihtsalt laialt kasutusel olevas, platvormist sõltumatus vormingus (nt CSV, XML), on need ka hõlpsasti ristkasutatavad. Kui andmete kogumise ja töötlemise protsess on põhjalikult dokumenteeritud ning andmed on varustatud litsentsiga, on need ka taaskasutatavad. Eesti avaliku sektori avaandmed on tehtud kättesaadavaks Eesti Avaandmete Portaalis. Ka enamikul ELi liikmesriikidel on oma avaliku sektori avaandmete portaalid. Suuremad rahvusvahelised teadusandmete repositooriumid on näiteks Zenodo, Harvard Dataverse (vaata ka teisi Dataverse’i projekte), OSF ja Figshare. Repositooriume võib omakorda otsida erinevatest registritest, nagu Re3data.org või OpenAIRE. Tartu Ülikool pakub TÜ raamatukogu kaudu võimalust säilitada oma teadusandmeid DataDOI repositooriumis. Seal saavad andmed endale digitaalobjekti identifikaatori ehk DOI ning need registreeritakse koos metaandmetega rahvusvahelises DataCite registris. DataCite Eesti koondab ka teisi Eesti teadusega seotud repositooriume. Raamatukogu on teinud ka põhjaliku ülevaate avatud teaduse repositooriumidest, avatud juurdepääsuga teadusandmebaasidest, andmehaldusest, kursustest, üritustest jm-st. Kui tahta oma andmeid avalikustada, tuleks nendele lisada litsents, mis määrab ära intellektuaalse omandi kasutusõiguse. Tüüpilised avaandmete litsentsid on: Litsents Valdkond Tuleb viidata Tohib levitada ainult sarnase litsentsiga CC0 Sisu, andmed Ei Ei PDDL Andmed Ei Ei CC-BY Sisu, andmed Jah Ei ODC-BY Andmed Jah Ei CC-BY-SA Sisu, andmed Jah Jah ODbL Andmed Jah Jah 5.2 Eesti ruumiandmed 5.2.1 Maa-ameti geoportaal Eesti ruumiandmete peamine haldaja ja levitaja on Maa-amet. Alates 2018. aasta suvest on väga suur osa Maa-ameti andmeid avalikud ning allalaetavad lehelt https://geoportaal.maaamet.ee/. Nende kasutamist käsitleb Maa-ameti avatud ruumiandmete litsents. Peamised punktid: Õigus kasutada andmeid tasuta, kasutaja valitud kõlbelisel eesmärgil, kooskõlas seaduste ja heade tavadega. Andmete publitseerimisel ja levitamisel peab viitama nende päritolule. Maa-amet ei vastuta otsese ega kaudse kahju eest, mis võib tekkida andmete kasutamisest tulenevalt. Maa-ameti kaudu on vabalt kasutatavad ka ajaloolise haldusjaotuse andmed, sh mõisate, kihelkondade, valdade, rajoonide kohta. Andmete kasutamisel tutvu kindlasti ka viitamistingimustega. 5.2.2 Statistikaamet Statistikaamet pakub avalikke andmeid sageli seotult mingite haldusüksuste andmetega (nt maakonnapõhiselt). Statistikaameti teemakaarte saab vaadata kaardirakenduse kaudu. Samuti on võimalik andmeid lihtsalt alla laadida ning haldusüksuse tulba kaudu ühendada Maa-ameti ruumiandmetega (nt saab statistikaameti maakondade näitajad siduda Maa-ameti vastavate maakondade polügoonidega). Samuti saab statistikaameti lehelt alla laadida nt Eesti rahvastiku paiknemise ruutkaardi, mis kujutab rahvaarvu 1 ruutkilomeetri kohta 2024. aasta andmete põhjal. Joonis 5.3: Eesti rahvastiku paiknemine statistikaameti ruutkaardil (2024) 5.2.3 Muud Eesti geoportaal koondab avalik-õiguslike asutuste ruumiandmeid ja nendega seotud metainfot. On seotud EL-i INSPIRE portaaliga (vt muude riikide ruumiandmete jaotist). Viited on koondatud kategooriate kaupa ruumiandmete kataloogi. Ruumiandmeid leiab mingil määral Eesti Avaandmete Portaalist, sh Maa-ameti ja Statistikaameti andmeid, aga ka näiteks kohalike omavalitsuste, registrite, ametite jt avaliku sektori institutsioonide andmeid. Tallinna ruumiandmed - Tallinna linna aluskaart, hooned, asumipiirid jpm. Tartu linna ruumiandmed. Digiteeritud kaarte leiab näiteks Rahvusarhiivi kaartide infosüsteemist ja Digarist. Nii Eesti kui ka välisriikide praeguseid ja endiseid nimekujusid leiab nii Eesti Keele Instituudi Kohanimeraamatust kui ka Kohanimeandmebaasist. Mõlema puhul on võimalik näiteks teadustöö eesmärgil saada enda kasutusse ka lähteandmeid (või osa nendest). Ametlikku kohanimeregistrit, mis esitab kohanimede ametliku, standardse nimekuju, haldab Maa-amet. TARA (Tartu Ülikooli arheoloogia infosüsteem): leidude, luude, proovide, arhiivi, fotode jms kogud. Kultuurimälestiste register: informatsioon kõikide Eestis riikliku kaitse all olevate mälestiste kohta, päringutulemustel sageli juures ka koordinaadid. Uurali keelte geograafiline andmebaas: Uurali keelte ruumiandmed ja valmis kaardid. Andrus Saareste “Eesti murdeatlase” (1938/1941) ja “Väikese eesti murdeatlase” (1955) andmed. 5.3 Muude riikide ruumiandmed Juurdepääsupiiranguta ruumiandmeid leiab internetist otsides hulganisti. Täpsed ruumiandmed on leitavad sageli huvipakkuva riigi enda avaandmete portaalidest. Siin on toodud vaid mõned üksikud näited üldisematest andmebaasidest ja repositooriumidest: INSPIRE on Euroopa Liidu ruumiandmete infrastruktuur, mis koondab ELi liikmesriikide ja EFTA riikide ruumiandmeid (sh Eesti andmeid). Natural Earth Data: vektorkujul rannajooned, maa, ookeanid, saared, jõed, järved jm. Olemas ka rasterandmeid aluskaartide jaoks. Open Maps for Europe: vektor- ja rasterandmed, veebiteenused. Geofabrik: OpenStreetMapi aluseks olevad andmekihid (SHP-formaadis andmed tasulised). MapTiler: erinevad maailma vektor- ja rasterpaanid (põhiliselt aluskaartide jaoks). Robin Wilsoni põhjalik nimekiri vabalt kasutatavatest ruumiandmetest. Ajalooliste kaartide kollektsioon. David Rumsey kaardikollektsioon: üle 100 000 kõrge kvaliteediga digiteeritud kaardi 16.-21. sajandist, osa ka georefereeritud. Arheoloogia andmete suurimaks koondajaks on Ariadne Plus, mis koondab üle 2 miljoni andmestiku kogu Euroopast. Projekti eesmärk on luua pilvepõhine virtuaalne teadustöö tegemise keskkond. ADS (Archaeology Data Sercive): juhtiv repositoorium arheoloogia ja laiemalt kogu pärandi andmete pikaajaliseks säilitamiseks ja jagamiseks. tDAR (The Digital Archaeology Record): rahvusvaheline arheoloogiliste uuringute andmete repositoorium. DANS (Data Archiving and Networked Services): Madalmaade digiandmete repositoorium. Pleiades - ajalooliste kohtade, riikide ja nimede ruumiandmed. Geographical database of the Uralic Languages - Uurali keelte (sh murrete) polügoonid ja punktandmed. Eri riikide tuntud inimeste kohta Vikipeediast kogutud andmebaas, mis on aluseks sellele rakendusele. Geoinfoga varustatud andmeid leiab ka mitmesugustelt üldistelt lehekülgedelt ja platvormidelt, mis võimaldavad andmeid koguda oma API (Application Programming Interface) abil. Samuti saab ruumiandmeid koguda nt Wikidata andmebaasist. 5.3.1 Harjutus Laadime Natural Earth Data lehelt alla maailma riikide polügoonide vektorandmed, mõõtkavaga 1:50 000 000 (Downloads → Medium scale data → Cultural → Admin 0 - Countries). Pakime allalaaditud faili lahti ning loeme SHP-faili QGISi (NB! Pane tähele CRS-i). Vaatame kihi atribuuttabelit. Kuidas on väljendatud halduslikke vaidluskohti (vt nt Iisrael)? Valime kihilt ainult Euroopa riigid. Selleks saame kasutada valiku tööriistu. Joonis 5.4: Valimise tööriistad menüüribal Objektide valimiseks teeme esmalt aktiivseks kihi, millelt valik teha. Valikut saab teha käsitsi või avaldiste abil. Valitud elemendid muutuvad vaikimisi kollaseks (värvi saab sätetes ka muuta). Valiku tööriistad: Select Features by Area or Single Click Select Feature(s): vali elemendid nendel hiirega klikkides, mitme elemendi korraga valimiseks hoia all Ctrl-klahvi; Select Features by Polygon: joonista hiirega polügoon, mille sisse jäävad elemendid valitakse, valiku lõpetamiseks tee paremklikk; Select Features by Freehand: joonista vabakäega mis tahes kujund, mille sisse jäävad elemendid valitakse, valiku lõpetamiseks tee uuesti vasakklikk; Select Features by Radius: vali elemendid, mis jäävad teatud raadiuse kaugusele määratud keskpunktist, keskpunkti määramiseks tee kuskil vasakklikk, valiku lõpetamiseks tee uuesti vasakkklikk; Select Features by Value Select Features by Value: vali elemendid, mille atribuuttabeli mingite tunnuste väärtused vastavad mingitele määratud väärtustele; Select Features by Expression: vali elemendid, mis vastavad avaldisega määratud tingimusele; Select All Features: vali kõik kihi elemendid; Invert Feature Selection: tee valik vastupidiseks (kõik valitud ehk kollased elemendid muutuvad mittekollaseks ja kõik mittekollased muutuvad kollaseks ehk valituks); Deselect Features from All Layers Deselect Features from All Layers: tühista valikud kõikidelt kihtidelt; Deselect Features from the Current Active Layer: tühista valikud ainult aktiivselt kihilt; Select by Location: vali elemendid, mis vastavad mingile geomeetrilise suhte määratlusele (nt vali kõik polügoonid, mis osaliselt kattuvad mingi teise polügooniga). NB! Ei tööta, kui kiht on vigane! Kõik valiku töööriistad leiad ka ülamenüüst: Edit → Select. Võiksime põhimõtteliselt kasutada tavalist Select Feature(s) valiku tööriista ja kõik Euroopa riigid Ctrl-klahvi all hoides järjest hiirega läbi klõpsida. Lihtsam on aga kasutada tööriista Select Features by Value (kiirklahv F3) ning valida automaatselt kõik need polügoonid, mille tulba REGION_UN väärtus on Europe. Seejärel võime Ctrl-klahvi all hoides ja Select Feature(s) tööriista kasutades valikust välja jätta alad, mida Euroopa kaardile ei taha jätta (nt Venemaa). Maailma riikide andmestiku puhul on tegemist multipolügoonidega, mistõttu tulevad Euroopa riike valides kaasa ka meretagused (koloniaal)alad. Kui tahaksime neid andmetest välja jätta, peaksime lahutama mitmikpolügoonid eraldi polügoonideks (Vector → Geometry Tools → Multipart to Singleparts, linnuta valik Selected features only). Tekib uus kiht (vaikimisi nimega Single parts), millelt saame seejärel uuesti valida nüüd ainult need polügoonid, mida tahame oma Euroopa kaardile jätta (nt tööriistaga Select Features by Polygon). Valitud riigid saame salvestada omaette Euroopa vektorkihina, kui teeme kihil paremkliki ning valime Export → Save Selected Features As. 5.4 Andmestike ühendamine Andmestike ühendamiseks on QGISis mitu erinevat viisi. 5.4.1 Ühendamine ühise tunnuse järgi Kui ühendame ruumiandmeid ja mitteruumiandmeid, saame kasutada mõlema andmestiku kattuva sisuga tulpasid. Näiteks võib meil olla olemas andmestik, milles ruumilist infot väljendavad ainult mingid tekstilised tunnused (riikide, maakondade, linnade, talude vm nimed). Nende tunnuste abil saame ühendada andmed avalikult ja vabalt kättesaadavate ruumiandmetega (nt Maa-ameti ruumiandmetega). Uurime, kuidas on maakondades 2021. aasta rahvaloenduse põhjal rahvaarv 2011. aasta andmetega võrreldes protsentuaalselt muutunud. Laadime QGISi Maa-ameti maakonnapiiride vektorkihi ja Moodle’is oleva CSV-andmestiku statistikaameti rahvaloenduse andmetega (NB! Statistikaameti andmetes ei ole koordinaate -&gt; No geometry). Ühendame maakondade vektorkihiga (!) statistikaameti rahvaloenduse andmed (ühine tulp on mõlemas andmestikus see, kus on maakondade nimed). Vaatame andmekihtide atribuuttabelitest, kas maakondade nimed on samal kujul. Teeme maakondade vektorkihil topeltkliki ning valime avanenud aknas vasakult jaotise Joins. Rohelisest plussmärgist lisame uue ühenduse (Add new join). Ühendatav kiht (Join layer) on meie rahvaloenduse andmete kiht, mille ühendamise jaoks kasutatav tulp (Join field) on tulp Elukoht. See tulp vastab ruumiandmete kihil tulbale MNIMI (Target field). Kuna elukoha ja maakonna nime tulba sisu kattub, ei ole mõlemat vaja ühendatud andmestikus alles hoida (Joined fields). Samuti ei taha me, et iga ruumiandmete kihile lisatava tulba nime ees oleks omakorda veel ühendatava kihi nimi (Custom field name prefix). Joonis 5.5: Mitteruumiandmete ühendamine ruumiandmetega Nüüd on maakondade vektorkihi atribuuttabelis ka rahvaloenduse andmed, mida saame edasi kaardil visualiseerida. Kui eelmisel korral vaatasime, kuidas kujundada kõiki kihi objekte (features) ühesuguselt (Symbology → Single symbol), siis nüüd tahame, et maakonnad oleksid värvitud erinevalt, vastavalt sellele, kas ja kui palju seal rahvaarv kasvas või kahanes. Praeguses atribuuttabelis on lihtsalt 2011. ja 2021. aasta rahvaarv, meil aga oleks vaja näidata muutust. Mugav viis selleks oleks teha atribuuttabelisse lihtsalt uus tulp, kus 2021. aasta rahvaarvust oleks lahutatud 2011. aasta rahvaarv. Kui rahvaarv kasvas, siis on väärtus positiivne; kui kahanes, siis negatiivne. Uue tulba lisamiseks avame maakondade vektorkihi atribuuttabeli (kiirklahv F6 või paremklikk ja Open Attribute Table) ning võtame lahti tööriista Field Calculator (kiirklahv Ctrl+I). . Joonis 5.6: Uue tulba lisamine atribuuttabelisse Uue tulba lisamine viib meie vektorkihi automaatselt muutmisrežiimi. Sellele viitab ka see, et atribuuttabeli ülamenüüs läheb aktiivseks kollane pliiats. Pliiatsil klõpsates saab muutmisrežiimi sisse ja välja lülitada. Selleks, et enda loodud tulp kihile salvestada ja muutmisrežiimist väljuda, peame pliiatsil nüüd uuesti klõpsama. Lisame ka protsentuaalse muutuse tulba MuutusProp, kus kajastame muutust protsentuaalselt ehk jagame tulba (Field) Muutus väärtused läbi 2011. aasta rahvaarvuga (Field 2011 Vanuserühmad kokku) ja korrutame saadud tulemuse 100ga. Kuna siin lubame arvudes ka komakohti, on Output field type sedapuhku mitte Integer, vaid Decimal. Lõpuks värvime maakonnad vastavalt protsentuaalse muutuse suunale ja suurusele. Selleks teeme maakondade vektorkihil topeltkliki ja liigume jaotisse Symbology. Single Symbol asemel valime väärtuse Graduated, mis võimaldab vektorkihi objekte (nt maakondade polügoone) kujundada vastavalt mingile arvulisele tunnusele kihi atribuuttabelis. Praegusel juhul on selleks tunnuseks (Value) loodud tunnus MuutusProp. Vajutame nupul Classify. Arvulise tunnuse alusel jagatakse vaatlused sagedusklassidesse. Klasside arvu saab muuta, samuti on klasside tekitamiseks erinevad meetodid: Equal Count (Quantile) - igasse sagedusklassi määratakse (enam-vähem) võrdne arv objekte Equal Interval - kõik sagedusklassid on sama suure intervalliga (nt 1-3, 4-6, 7-9 jne), intervalli suuruse määrab klasside arv Fixed Interval - kõik sagedusklassid on sama suure intervalliga, intervalli suuruse määrab kasutaja Logarithmic Scale - rohkem tuuakse esile erinevusi väikeste väärtuste vahel (NB! ei tööta negatiivsete väärtustega) Natural Breaks (Jenks) - sagedusklasse luuakse nii, et sama klassi väärtused oleksid üksteisega võimalikult sarnased ja teistest klassidest võimalikult erinevad Pretty Breaks - kõik sagedusklassid on enam-vähem sama suure intervalliga, klassi piiridena kasutatakse lihtsaid, ümardatud väärtusi, mistõttu vähima ja suurima sagedusklassi intervall võib teistest erineda Standard Deviation - võrdsete intervallidega sagedusklassid, intervallid põhinevad standardhälbel (näitab, kui palju mingi arvuline väärtus erineb keskmisest) Selles ülesandes võiks üks klass võimalusel väljendada kuni 5 protsendipunkti muutust (pretty breaks). Valime sellise värviskaala (nt PRGn või RdBu), mis väljendaks skaala kumbagi äärmist otsa (suuri kasvuprotsente ja suuri kahanemisprotsente) eri värvidega. Joonis 5.7: Maakondade värvimine vastavalt protsentuaalsele muutusele rahvaarvus Salvestame kaardi pildifailina. Lisame kaardile ka pealkirja, legendi ja viite kasutatud andmetele. Veidi paindlikumaid võimalusi ruumiandmete ja mitteruumiandmete ühendamiseks pakub Processing → Toolbox → Vector general → Join attributes by field value. Näiteks kui on vaja ruumiandmete koordinaate määrata mitmele sama atribuudi väärtust omavale objektile korraga (nt andmestikus on mitu Harju maakonna vaatlust), saame kasutada seal ühendamisviisi one-to-many. 5.4.2 Geokodeerimine Täpsemate asukohtade määramiseks (nt aadresside jaoks) saab kasutada geokodeerimise teenust. Geokodeerimine on aadressi või kohanime seostamine geograafiliste koordinaatidega. Tagurpidi geokodeerimine omakorda võimaldab koordinaatidest tuletada aadressid ja kohanimed. QGISis on sisse-ehitatud geokodeerija, mis annab ka tänapäevaste andemetega küllaltki häid tulemusi: Processing → Toolbox → Vector general → Batch Nominatim geocoder. Ka Maa-amet pakub tasuta geokodeerimise teenust. Sealjuures on võimalik geokodeerida nii ainult üht aadressi/kohta korraga kui ka tervet hulka andmeid (massgeokodeerimine). Massgeokodeerimise sisendiks sobivad CSV- või XLSX-formaadis andmetabelid. CSV-formaadi puhul peab välju eraldama semikoolon. Vaatame seda lühikese näite abil, kus geokodeerime Tartu Ülikooli valdkondade dekanaatide ametlikud aadressid. Kodeerimisel peab ära määrama, millises tulbas paikneb sisendaadress, mida geokodeerima hakatakse. Antud juhul on selleks tulp aadress. Seejärel saab valida mh, milliste objektide hulgast vasteid otsitakse. Meid huvitavad siin eeskätt õppehooned, aga veidi ebatäpsemate aadresside puhul (talud, tänavad, maakonnad, linnad jne) tasub otsida ka teiste objektide seast; kuidas vasteid esitatakse. Eeskätt puudutab see aadresse, millel on kas mitu vastet või millele täpset vastet ei leita. Lõpuks saab valida, milliseid ruumiandmete tulpasid väljundisse soovime (nt kas kõiki aadressiobjektide id-sid ja tasemeid); kas tahame, et andmeid töödeldaks sünkroonselt, mispuhul saame protsessi jälgida kohe samas veebilehitseja aknas, või asünkroonselt, mispuhul andmed laetakse serverisse ning kasutajale saadetakse mõne aja pärast tulemus meilile. Viimast tasub teha eeskätt siis, kui andmestik on mahukas. Geokodeerimine töötab väga hästi tänapäevaste aadressidega. Vaatame aga nüüd ka natuke vanemaid andmeid, nimelt Rahvusarhiivi kaudu kasutatavat Tartu Ülikooli ja Eesti Ajalooarhiivi andmebaasi “Album Academicum 1918–1944”, mis koondab matrikliraamatutele jt allikatele tuginedes infot Tartu Ülikooli immatrikuleeritud üliõpilastest aastatel 1918-1944 (vaata lähemalt). Kuna andmestik ise on üpris mahukas, sisaldades infot enam kui 20 000 tudengi kohta, siis vaatame siin ainult Pärna-, Pähna-, Lõhmuse- ja Niine-nimeliste üliõpilaste andmeid ning võrdleme nende päritolu. Tahame teada, kas eri perekonnanimedega üliõpilaste sünnikohad korreleeruvad perekonnanimes oleva sõna levikualaga murretes. Naisüliõpilaste andmete puhul ei pruugi võrdlus olla väga täpne, kuna andmestikus sisalduvad ka need kirjed, kus perekonnanimi on saadud abiellumisel. Joonis 5.8: Sõnade levik murretes (Väike murdesõnastik) Oleme veidi algandmestikku täiendanud ning lisanud standardiseeritud sünnikoha tulbad, kus andmebaasis kajastatud sünnikohtadel on lühendid lahti kirjutatud ning erinevate tasemete kohanimed on lahku löödud. Põhimõtteliselt võib proovida ka praktikumis tabelit massgeokodeerimisse saata (sel juhul tasub otsida ilmselt ainult haldus- ja asustusjaotuse klassifikaatorist), ent kui teeme seda kõik koos, võib server saada üle koormatud. Seepärast oleme lisanud praktikumi materjalidesse ka juba geokodeeritud faili parn_niin_lohmus_pahn.gpkg, mis kasutas aadressidena tulpa Sünnikoht, kus on kogu sünnikoha täiskirje, ning lisasammudena tulpasid tase3, tase2 ja tase1, milles sünnikoha info erinevad tasemed olid lahku löödud (kõige spetsiifilisem kohanimi tulbas tase3). Otsitud on maakonna/omavalitsuse/asustusüksuse/linnaosa objekte. Laadime geokodeeritud andmestiku QGISi. Valime andmetele sobiva aluskaardi (nt eelmisel korral kasutatud kihelkondade kaardi). Värvime punktid selle järgi, kas tegemist on Pärna-, Pähna-, Lõhmuse- või Niine-nimeliste üliõpilastega (tulp pk). Selleks teeme vektorkihil topeltkliki ja liigume jaotisse Symbology. Single Symbol asemel valime väärtuse Categorized, mis võimaldab vektorkihi objekte (nt maakondade polügoone) kujundada vastavalt mingile kategoriaalsele/tekstilisele tunnusele kihi atribuuttabelis. Praegusel juhul on selleks tunnuseks (Value) loodud tunnus pk. Vajutame nupul Classify. Teeme punkte suuremaks, viime punktide läbipaistvuse 50% peale, vahetame soovi korral punktide värvi ja sümboleid. 5.4.3 Ühendamine ruumiinfo järgi Kui kasutada on näiteks kaks vektorkihti, mis mõlemad sisaldavad ka ruumiandmeid, saame ühendada neid ka ilma ühise atribuudita, koordinaatide põhjal. Loeme sisse eelmisel korral kasutatud kohapärimuse punktikihi ja ajalooliste kihelkonnapiiride polügoonikihi. Oletame, et tahame värvida eri värvi neid kihelkondi, kust meil kohapärimuse andmeid on. Vaatame kihtide atribuuttabeleid. Mõlemal kihil on olemas kihelkonnanimedega tulp ning info näib olevat samal kujul. Seega võiksime põhimõtteliselt ühendada punktikihi kihelkondade kihiga ning teha värviliseks ainult need kihelkonnad, kust kohapärimuse kihilt tulevates tulpades midagi on. Joonis 5.9: Kihelkondade värvimine vastavalt kohapärimusele Kui aga tahame värvida kihelkondi selle järgi, kui palju kuskilt kihelkonnast kohapärimuse andmeid on, jääksime siin hätta, kuna kihelkonnakihil on iga kihelkonna kohta ainult üks rida, meil võib aga ühest ja samast kihelkonnast olla mitu pärimusjuttu. Siin saame kasutada valikut Processing → Toolbox → Vector general → Join attributes by location (summary). Siin kohtame taas geomeetrilisi predikaate. + equals - kahel objektil täpselt samad koordinaadid + intersects - kaks objekti katavad vähemalt mingeid ühiseid koordinaate (sh nt servi) + crosses - kaks objekti lõikuvad nii, et lõikumiskoht on madalama dimensionaalsusega kui objektid ise + overlap - kaks objekti katavad mingeid ühiseid koordinaate, aga ei ole täpselt ühesugused, kohakuti ega ainult servapunktidest kattuvad + touches - kaks objekti puutuvad kokku ainult servadest, aga objektide siseosa ei kattu + within - esimene objekt tervenisti teise sees + contains - teine objekt tervenisti esimese sees Kasutame geomeetrilist predikaati contains, sest tahame teada, millised punktid jäävad iga kihelkonna polügooni sisse (võivad ka polügooni sisemise piiriga külgneda) ja teame, et kõik punktid jäävad Eesti riigi maakondade piiridesse. Samuti võime igaks juhuks märkida meetodina ära intersects, juhuks kui mõni punkt asub täpselt maakondade polügoonide piiril. Joonis 5.10: Kohapärimuse punktide kokkulugemine kihelkonnapiirides Kuna vektorkihi geomeetria on vigane, saame veateate. Võime kihi ära parandada (Processing → Toolbox → Vector geometry → Fix geometries) või valida ühendamise aknas alt vasakult nurgast Advanced → Algorithm Settings → Invalid feature filtering ja määrata väärtuseks Skip (Ignore) Features with Invalid Geometries. Viimasel juhul jäetakse vigased polügoonid uuelt loodavalt kihilt välja. Ühendamise käigus tekkinud kihil võime nüüd polügoonid värvida kas tulba NIMETUS_count järgi, kui tahame näidata lihtsalt, kui palju tekste/helisalvestisi/videoid mingist kihelkonnast oli (kõik Pühajõest rääkivad tekstid loetakse eraldi kokku), või NIMETUS_unique, kui tahame näidata, mitmest unikaalsest objektist räägiti (Pühajõgi läheb arvesse ainult ühe korra). Kasutame Graduated visualiseerimist. Selleks, et näha jääksid ka kihelkonnad, kust ühtegi punkti ei ole (e kus tulpades on väärtus NULL), peame pärast sagedusklasside moodustamist lisama eraldi klassi ka nendele juhtumitele. Valime Graduated asemel Rule-based, lisame rohelisest plussmärgist uue reegli, mille sildiks määrame 0 ning reegli kirjutamise asemel valime lihtsalt valiku Else. Joonis 5.11: Reegli lisamine kujundamisel "],["georefereerimine.html", "Praktikum 6 Georefereerimine 6.1 Kaartide otsimine ja allalaadimine 6.2 Harjutus 1: vana Tartu kaardi georefereerimine 6.3 Harjutus 2: ajalooline maakasutus Jägala mõisa külades 6.4 Harjutus 3: käsikirjalise kaardi georefereerimine", " Praktikum 6 Georefereerimine Georefereerimine on raster- või vektorandmete sidumine geograafilise või projitseeritud koordinaatide referentssüsteemiga. Näiteks võime koordinaatide referentssüsteemiga siduda ajaloolise kaardi või ortofoto. Tänapäeval tehakse seda peamiselt digitaalselt. Georefereerimiseks tuleb märkida samad kohad võimalikult täpselt georefereeritaval kaardil või fotol ja (tänapäevasel) kindlas koordinaatide referentssüsteemis oleval aluskaardil. Georefereerimise tulemusel luuakse rasterkujutisest uus GeoTIFF fail või lisatakse olemasolevale failile nn world file, milles on defineeritud rastri asukoht, mõõtkava ja pöördenurk. GeoTIFF-faili nägime ka QGISi sissejuhatavas praktikumis, kui laadisime QGISi Tartu 1995. ja 2023. aasta ortofotod. Tänases praktikumis otsime välja ajaloolised kaardid, mida soovime QGISis kasutada, georefereerime need, lõikame vajalikku suurusesse ning digiteerime neilt huvipakkuvad objektid. 6.1 Kaartide otsimine ja allalaadimine Otsime Rahvusarhiivi kaartide infosüsteemist ra.ee/kaardid kaardi 19. saj Tartust ning 17. saj kaardi Jõelähtme ja Jägala-Joa piirkonnast. Näidetes kasutame järgmisi kaarte: Plan der Stadt Dorpat mit Bezeichnung der hervorragenden Gebäude und Sämmtlicher Hausnummern, EAA.402.5.637 (leht 73), 1870. Tartu linna kaart koos silmapaistvate hoonete ja majanumbritega. Joonis 6.1: Tartu kaart 1870. a Jackowal Hofs Byar uti Jegelecht Sochn belägne, EAA.1.2.C-III-8, 1688. Jägala mõisa külad Jõelähtme kihelkonnas. Joonis 6.2: Jägala mõisa kaart 1688. a Võib kasutada samu või muid sarnaseid kaarte nendest piirkondadest. Laadime kaardid alla ning tõstame need enda arvutis kursuse kaustas andmete või kaartide kausta. 6.2 Harjutus 1: vana Tartu kaardi georefereerimine Avame QGISi. QGISis on georefereerimise tööriist Georeferencer leitav ülevalt menüüst Layer alt. Vanemates QGISi versioonides leiad tööriista Raster menüü alt. Juhul, kui seal valikut Georeferencer ei ole, siis tuleb see aktiveerida. Selleks vali Plugins → Manage and Install Plugins → otsingusse kirjuta Georeferencer → tee linnuke Georefencer GDAL Plugin ette ja sulge see aken. Nüüd on tööriist Georeferencer rastrimenüü all näha. Tööriista sisselülitamine on ühekordne tegevus, järgmisel korral QGISi avades on see juba olemas. Georefereerimise tööriista kohta saab täpsemalt lugeda QGISi juhendist. 6.2.1 Avame kaardi pildifaili Avame Georeferencer tööriista ning selles 19. saj Tartu kaardi: File → Open Raster. Selles aknas liikumine käib samamoodi nagu tavalises kaardiaknas. Suumida saab hiire rullikuga ning liikuda noolte ja hiirega liikuda, kui valitud on käekujuline Pan ikoon. Vaatame kaardil ringi. Milliseid kohti ära tunneme? 6.2.2 Lisame aluskaardi Georefereerimiseks on vaja aluskaarti, mille pealt leida ühised punktid ajaloolise kaardiga. Selleks laadime QGISi põhiaknasse Maa-ameti fotokaardi WMS-teenusest ortofoto ning ajalooliste aluskaartide WMS-teenusest Hübriidkaardi. Nende kasutamiseks tuleb luua ühendus aadressidega https://kaart.maaamet.ee/wms/fotokaart? ja https://kaart.maaamet.ee/wms/ajalooline?. WMS-ühenduse loomisest on täpsemalt juttu näiteks QGISi sissejuhatavas praktikumis. Lisaks laadime ajalooliste kaartide WMS-teenusest ka üheverstase ja kolmeverstase kaardi, millega on hea georefereerimisel tänapäevast olukorda kõrvutada. Need kaardid ise on samuti georefereeritud ning võivad olla seetõttu kohati ebatäpsed. 6.2.3 Georefereerime kaardi Märgime ära mõned ühesugused geograafilised punktid georefereeritaval kaardil ja tänapäevasel aluskaardil. Selleks võtame ette jälle Georeferencer akna. Georefereerija aknas valime Edit → Add GCP point ja klikime georefereerimise aknas ajaloolisel kaardil mõnel hästi tuvastataval objektil. Näiteks TÜ peahoone, raekoda, kaarsild, tähetorn, Jaani kirik vms. Võib ka kasutada näiteks tänavate ristumiskohti. Seejärel valime avanenud aknas From map canvas ning klikime tänapäevasel aluskaardil samas kohas. Vajutame OK. Joonis 6.3: Sama asukoha märkimine Märgime samamoodi veel neli kuni kümme punkti kaardil. Võimalusel asetame punktid kaardil võimalikult laiali, sest nii saab suurema ala kohta täpsema tulemuse. Kui tahame, et aluskaart oleks sama nurga all nagu georefereeritav kaart, võime aluskaarti QGISi peaaknas mingi nurga alla keerata. Selleks saab alamenüüs muuta Rotation parameetri väärtust. Seejärel tuleb valida georefereerimise sätted. Klikime georefereerija aknas kollasel hammasrattal ja vaatame, et sätted oleksid nii nagu siinsel pildil. Joonis 6.4: Georefereerimise sätted Vajutame rohelisel noolekesel Start Georeferencing. Nüüd ilmub georefereeritud kaart QGISi peaaknasse (juhul, kui sätetes oli tehtud linnuke valiku Load in QGIS when done ette). Kui georefereerimine ei õnnestu (nt jookseb QGIS georefereerimisel kokku, siis vali mõni muu algoritm, nt Polynomial 1). Vaatame, kui hästi tänapäevase koordinaatide referentssüsteemiga sidumine õnnestus. Kui kaart on väga paigast ära, siis saame lisada rohkem punkte või muuta transformatsiooni tüüpi. Vastavatest algoritmidest saab täpsemalt lugeda tööriista Georeferencer juhendist, ent lühidalt: Linear algoritm sobib põhiliselt siis, kui tegu on kõrge kvaliteediga rasterkaardiga, mille koordinaatide referentssüsteem on teada. See kohandab kaardi mõõtkava, ent ei võimalda kujutist pöörata ega muul moel muundada, kuna ei muuda originaalkujutise piksleid. Enamasti sobib see seega uuematele kaartidele, mis on (kindlas projektsioonis) suure täpsusega. Helmerti algoritm sobib hea kvaliteediga suuremõõtkavalistele rasterkaartidele või ortofotodele, mille koordinaatsüsteem ei pruugi ühtida aluskaardi omaga. Võimaldab kujutist ka pöörata. Polynomial 1. algoritm lubab georefereeritavat kujutist rohkem muundada, aga tagab siiski selle, et sirged jooned kaardil jääksid sirgeteks ja paralleelsed jooned paralleelseteks. Polynomial 2. ja 3. algoritm lubavad kujutist veelgi rohkem muundada, sh painutada kujutisel olevaid sirgeid jooni. Projective algoritm on nagu Polynomial 1. algoritm, aga ei säilita joonte paralleelsust ning eri punktidel võib georefereeritud kaardi ulatuses olla lõpuks pisut erinev mõõtkava. Thin Plate Spline algoritm sobib eriti hästi väga ebatäpsetele kaartidele või kaartidele, mille projektsioon ei ole teada. Sälitab märgitud punktide asukohad, ent võib moonutada kõike, mis jääb punktidest eemale. Nõuab heaks tulemuseks algoritmidest kõige enam punkte (vähemalt 10). Joonis 6.5: Põhilised georefereerimise algoritmid (gis.stackexchange.com) Kui georefereerimise algoritmid moonutavad algse kujutise piksleid, tuleb uues, georefereeritud rasterfailis määrata korrapärases rastris sellistele pikslitele mingid uued väärtused. Seda tehakse originaalkujutise naaberpikslite abil. Resampling method määrabki ära, kui palju ja milliseid naaberpiksleid uue väärtuse määramisel arvestada. Joonis 6.6: Georefereerimise Resampling meetodid (The Core of GIS Science 2020) Joonis 6.7: Georefereeritud Tartu kaart hübriidkaardi ja ortofoto taustal Võime soovi korral lisada nüüd juurde punkte, neid liigutada või mängida sätetega, et saada paremat tulemust. Proovime näiteks ka Helmerti algoritmi ja Polynomial 1 algoritmi. 6.2.4 Lõikame kaardist välja ainult vanalinna osa Rastri lõikamiseks valime menüüst Raster → Extraction → Clip raster by extent. Vaatame, et Input layer oleks georefereeritud kaart, Clipping extent juures klikime sirvimise ikoonil ja valime Draw on canvas ning joonistame peaaknas nelinurga, mis kataks suurema osa vanalinnast. Clipped (extent) juures klikime sirvimise ikoonil, valime Save to File ning salvestame faili sobiva nimega kursuse kausta. Klikime nupul Run. Joonis 6.8: Georefereeritud Tartu vanalinna kaart Nüüd on lõigatud kaart peaaknas näha. Sellist lõikamist (ingl clipping) saab teha ka vektorkihi abil, aga sellest hiljem. 6.3 Harjutus 2: ajalooline maakasutus Jägala mõisa külades Harjutuse eesmärk on uurida ühe Põhja-Eesti küla ajaloolist maakasutust. Selleks tuleb georefereerida kaart, see osaliselt digiteerida ning arvutada digiteeritud alade pindalad. Digiteerimine tähendab uuele, tühjale vektorkihile punkt-, joon- või polügoonobjektide lisamist koos nende atribuutide väärtustega. 6.3.1 Kaardi georefereerimine Georefereerime Jägala mõisa külade 17. sajandi kaardi, kasutades samu aluskaarte, mida varem. Praema võrdlemise jaoks võime aluskaarti jällegi pisut keerata (nt 20 kraadi). Kuna niivõrd vanal kaardil on hooneid, teid ja muid pidepunkte vähem, siis on soovitatav pidepunktidena kasutada looduslikke objekte. Sellel kaardil on heaks pidevaks objektiks jõgi. Valime sobiva transformeerimise algoritmi (nt Helmert). Pärast georefereerimist võime ajaloolist kaarti ka pisut läbipaistvamaks teha, et vaadata, kui hästi see aluskaardiga klapib (topeltklikk georefereeritud kaardil → Transparency → Global Opacity. Joonis 6.9: Jägala jõe ümbruse georefereeritud kaart 6.3.2 Digiteerimine Loome tühja vektorkihi alade (Polygon) märkimiseks: Layer → Create Layer → New Geopackage Layer (võid valida ka muu vektorandmete vormingu) ja paneme selle nimeks nt koila_maakasutus. Lisame kihi atribuutide hulka ka tekstilise tunnuse/atribuudi/tulba (string) nimega tyyp. Joonis 6.10: Maakasutuse digiteerimise kihi tegemine Nüüd on maakasutuse alade märkimiseks loodud tühi kiht, mis ilmus ka kihtide paneelile. Seda kihti paneelil sisse-välja lülitades ei juhtu hetkel midagi, kuna sellel pole veel ühtegi punkti. Kihi atribuuttabelit vaadates on näha, et see on tühi. Digiteerime georefereeritud 17. sajandi kaardilt Koila küla põllud ja heinamaad. Iga märgitud ala juurde kirjutame, kas see on põld või heinamaa. Kaardi tingmärkide tuvastamisel on abiks Rahvusarhiivi leppemärkide juhend. Koila küla põllumaade tuvastamisel vaadake ajaloolise kaardi vasakul all nurgas olevat legendi. Koila küla on tähistatud B tähega (Koillküla, vt nt EKI kohanimeraamatut). Klikime kihtide paneelil kihil koila_maakasutus ja vajutame üleval tööriistaribal kollasele pliiatsile (või Layer → Toggle editing). Pliiatsi kõrval olevad ikoonid muutuvad värviliseks. Valime kollasel taustal oleva valge tähekesega ikooni Add Polygon Feature. Nüüd saame kaardile polügoone märkida. Märgime hiirega klõpsates ühe digiteeritava põllumaa polügooni piirid. Kui oleme lõpetanud, teeme paremkliki. Avanenud aknas peame polügoonobjektile määrama atribuudi tyyp väärtuse. Määrame selleks põld. Kuna põllu- ja heinamaad piirnevad üksteisega, siis on kasulik aktiveerida haakumine ehk snapping, et üksteisega külgnevate alade ühised käänupunktid oleksid täpselt samade koordinaatidega. Selleks valime View → Toolbars → Snapping Toolbar klikime punasel magneti ikoonil ja valime selleks, mille külge haakida, käänupunktid (Vertex). Nüüd haakub kursor kihi läheduses automaatselt selle käänupunktide külge. Joonis 6.11: Alade digiteerimine Haakimise lihtsustamiseks võib sisse lülitada ka tööriista Enable tracing , mis võimaldab üht vektorobjekti teise külge haakida, ilma et peaks kõiki punkte käsitsi läbi klikkima. Piisab vaid kursori liigutamisest üle teise vektorobjekti käänupunktide. Vahel, kui tahame ükshaaval käänupunktide märkimist lihtsustada ja “joonistada” lihtsalt vaba käega, võime valida pliiatsi kõrvalt tööriista Stream Digitizing. Joonis 6.12: Digiteerimine vabakäe meetodil Kui oleme alad digiteerinud, vajutame Save ja uuesti kollase pliiatsi ikooni, et lõpetada korraks kihi muutmine. 6.3.3 Pindalade arvutamine Arvutame igale märgitud alale selle pindala. Selleks tuleb atribuuttabelisse luua pindala tulp ja sisestada avaldis selle arvutamiseks. Avame tööriista Field Calculator (nt tööriistapaneelilt või atribuuttabeli juurest). Teeme linnukese valiku Create a new field ette, tulba nimeks paneme pindala_ha ja tulba andmetüübiks määrame kümnendmurru (Decimal number (real)). Expression lahtrisse, mis ütleb, kuidas ja mille põhjal loodud tulpa väärtusi lisada, kopeerime koodi round($area / 10000, 2). See arvutab iga ala pindala ruutmeetrites ($area), jagab selle 10 000-ga ehk teisendab hektariteks ja lõpuks ümardab tulemuse (round()) kahe komakohani. Joonis 6.13: Pindala arvutamiseks tulba loomine ja kasutatud funktsioon Tulemuseks on kiht, mille atribuuttabelis on olemas alade pindalad. Seda saab kasutada näiteks maakasutuse ulatuse ja muutuste uurimiseks. Joonis 6.14: Digiteeritud maa-alad 6.4 Harjutus 3: käsikirjalise kaardi georefereerimine Georefereerime kaartide praktikumis käsitsi joonistatud kaardid Tartu kesklinnast. Valime sobivaima algoritmi. "],["avaldised.html", "Praktikum 7 Avaldised ja päringud 7.1 Andmed 7.2 Avaldised 7.3 Harjutused avaldistega 7.4 Päringud 7.5 Harjutus päringutega 7.6 Ülesanded", " Praktikum 7 Avaldised ja päringud 7.1 Andmed Impordime tänaseks praktikumiks QGISi kihelkondade shapefile’i (EKI, Peeter Päll; erineb pisut Maa-ameti ruumiandmete lehel olevast andmestikust; on kasutusel nt eesti murrete korpuses), shapefile’i, mis sisaldab andmeid ei ole ja pole eituskonstruktsioonide leviku kohta eesti murretes Andrus Saareste 1955. aasta “Väikese Eesti murdeatlase” põhjal, CSV-faili, mis sisaldab andmeid ei ole ja pole suhtelisest sagedusest Eesti murrete korpuses. NB! Kodeering on UTF-8, välju eraldab semikoolon, esimesel real on tulbanimed ning koordinaatide infot failis ei ole. Eesti murrete korpus sisaldab transkribeeritud murdeintervjuude tekste 10 traditsiooniliselt murdealalt. Tekstid on suuremas jaos salvestatud 1960.-1970. aastatel. Korpusest on võimalik teha päringuid nii sõnajärjendite kui ka märksõnade põhjal, et näha näiteks, milline on erinevate keelendite sagedusjaotus eri piirkondade murdetekstides. Joonis 7.1: Lisatud kihid Kui soovid võrrelda, kuidas EKI kihelkondade kaart klapib Maa-ameti kihelkondade kaardiga, võid taustaks panna veel WMS-i või WFS-i kaudu Maa-ameti ajaloolise haldusjaotuse kaardi: https://teenus.maaamet.ee/ows/wms-ajalooline-haldus?. Ei ole ja pole tunduvad eesti keeles paljudes kontekstides ekvivalentsed, samatähenduslikud ja sama funktsiooniga variandid. Sellel varieerumisel on aga ka oma murdetaust: mõned murded eelistavad analüütilist ei ole konstruktsiooni, teised sünteetilist pole konstruktsiooni, ehkki tegemist ei ole selgelt kategooriliste eelistustega (“kasutan ainult üht ja mitte kunagi teist”). 7.2 Avaldised Avaldised (expressions) on tehted ja vormelid, mille abil hõlpsalt muuta atribuutide väärtusi, luua uusi (virtuaalseid) atribuute või kihte, andmetest alamhulki välja filtreerida, teha statistikat jne. Avaldiste abil saab andmeid QGISis mitmekülgsemalt analüüsida ning visualiseerida. Avaldisi saab QGISis kasutada mitmes kohas, näiteks objektide valimiseks Select Features by Expression tööriista abil , objektide valimiseks atribuuttabeli alumisest vasakust nurgast Advanced Filter (Expression) , atribuutide muutmiseks ja lisamiseks Field calculator’is , päringute tegemiseks Query builder’is (Layer Properties → Source → Query Builder) , päringute tegemiseks Database Manager’is (Database → DB Manager) , sümbolite, siltide või paigutuse parameetrite muutmisel (Symbology) jne. Avaldisi saab eeldefineeritud funktsioonide abil koostada niisiis mitmeks erinevaks otstarbeks, vaata ülevaadet QGISi juhendist. Sealjuures saab üht ja sama asja teha sageli erineval moel. Oleme juba lihtsate avaldistega kokku puutunud, kui arvutasime eelmisel korral digiteeritud polügoonide pindala (6.13): round($area / 10000, 2). Vaatame sel korral harjutuste ja ülesannete toel lähemalt operaatoreid (Operators), matemaatilisi funktsioone (Math), tingimuslauseid (Conditionals) ning teksti muutmise võimalusi (String). Operaatorid ja funktsioonid, millega tänases praktikumis kokku puutume, on -: lahuta ühest väärtusest teine; &gt;: leia, kas üks väärtus on suurem kui teine (tagastab 1 (TRUE) või 0 (FALSE)); &gt;=: leia, kas üks väärtus on suurem kui teine või sellega võrdne (tagastab 1 (TRUE) või 0 (FALSE)); IS: mingi (atribuudi) väärtus peab olema mingi kindel väärtus (sama, mis =, tagastab 1 (TRUE) või 0 (FALSE)); IS NOT: mingi (atribuudi) väärtus ei tohi olla mingi kindel väärtus (sama, mis !=, tagastab 1 (TRUE) või 0 (FALSE)); ILIKE: kas mingi (atribuudi) väärtus vastab mingile kindlale mustrile (tõstutundetu)? (tagastab 1 (TRUE) või 0 (FALSE)); OR: operaator VÕI (tagastab 1 (TRUE) või 0 (FALSE)); if(tingimus, kuikehtib, kuieikehti): kui kehtib mingi tingimus, määratakse mingi väärtus, kui ei kehti, siis mingi muu väärtus (sama, mis CASE ... WHEN ... THEN ... ELSE ... END); length(tekst): leia mingi teksti/sõne pikkus tähemärkides; replace(tekst, midaasendada, millegaasendada): asenda tekst või selle mingi osa muu tekstiga; regexp_replace(tekst, midaasendada, millegaasendada): asenda tekst või selle mingi osa muu tekstiga, kasutades regulaarvaldisi. 7.3 Harjutused avaldistega Harjutus 1: operaatorid objektide valimiseks Kasutame valiku tööriista (Select Features by Expression), et teha aktiivseks kõik need kihelkondade polügoonid, millel on midagi kirjutatud tulpa Problem (nt selleks, et hakata parandustega tegelema). Kõikide atribuutide/tulpade nimed ja tüübid saab kätte jaotisest Fields and Values. Nupp All Unique näitab atribuudi kõiki eri väärtuseid, nupp 10 Samples sellest kuni kümmet esimest eri väärtust. Topeltklikk atribuudi nimel liigutab jutumärkide vahel oleva atribuudi vasakul asuvasse avaldise kasti. Avaldiste kastis viidataksegi topeltjutumärkidega atribuuttabeli mingile tunnusele (= tulbanimele), ühekordsete jutumärkidega mingitele tekstilistele väärtustele (nt kui küsime tulbast Parish_id Pühalepa kihelkonna rida, siis peaksime kirjutama avaldise \"Parish_id\" = 'Phl' või \"Parish_id\" IS 'Phl'). Jaotuse Operators alt leiame terve hulga sümboleid, mille abil teha nt arvutustehteid, võrdlustehteid või tekstitöötlust, sh vajamineva operaatori IS NOT. Tahame leida niisiis atribuuttabelist neid ridu, kus tulp Problem ei ole tühi: \"Problem\" IS NOT NULL. Vajutame nupul Select Features. Joonis 7.2: Probleemsed kihelkonnad Harjutus 2: tingimuslaused uute atribuutide/tunnuste loomiseks Kasutame väljakalkulaatori tööriista (Field Calculator), et lisada ei ole/pole atlase levikuandmetesse virtuaalne (st ajutine) tekstiatribuut nimega saj19, kus oleks väärtus jah ridadel, kus keelejuhi sünniaeg on väiksem kui aasta 1900, ei, kui keelejuhi sünniaeg on hilisem, ja ei tea, kui keelejuhi sünniaega pole märgitud. Virtuaalse atribuudi lisamiseks valime Field Calculator’is Create a new field → Create virtual field, atribuudi nimeks paneme saj19, atribuudi tüübiks valime Text (string). Siin läheb vaja tingimuslauseid jaotises Conditionals. Kasutame siin funktsiooni if, mille järel sulgude sees komadega eraldatult tuleb anda esmalt tingimus (“Kas tulbas SaKJSynd olev arv on väiksem kui 1900?”), seejärel väärtus juhul, kui tingimus vastab tõele, ning lõpuks väärtus juhul, kui tingimus ei vasta tõele: if(\"SaKJSynd\" &lt; 1900, 'jah', 'ei'). Meil on aga atribuuttabelis ka sellised read, kus keelejuhi sünniaeg võrdub 0-ga või on NULL, sest see pole teada. Meil oleks oluline märkida ära, et nende puhul me tegelikult sünniaega hinnata ei oska: if(\"SaKJSynd\" IS 0 OR \"SaKJSynd\" IS NULL, 'ei tea', if(\"SaKJSynd\" &lt; 1900, 'jah', 'ei')): Kui tulbas SaKJSynd on väärtus 0 VÕI polegi midagi (NULL), märgi tulpa saj19 väärtus ei tea, vastasel juhul kui tulbas SaKJSynd on väärtus, mis on väiksem kui 1900, märgi tulpa saj19 väärtus jah, vastasel juhul väärtus ei. Joonis 7.3: Uue tulba tekitamine Harjutus 3: tekstiavaldised sümbolite kujundamiseks (1) Värvime kihelkonnad selle järgi, kui mitu tähte nende nimes on, aga nii, et me ei pea atribuuttabelisse selleks eraldi tunnust looma. Valime kihelkondade kihi Symbology jaotise alt Graduated ja Value puhul ühe konkreetse tunnuse nime valiku asemel vajutame lahtri kõrval olevat avaldise sümboliga nuppu . Kihelkondade nimed on tulbas Name. Teksti/sõne pikkuse leidmiseks on jaotise String all funktsioon length: length(\"Name\"). Lisame ka sildid, et kontrollida, kas värvilegend peab paika. Alloleva kaardi saamiseks teeme veel mõned kujunduslikud sammud: Symbology → Graduated → Symbol → Simple Fill: muudame polügoonide piirjoonte (Stroke) läbipaistvust 16% peale; teeme linnukese Draw effects valiku ette ja vajutame kollasel tähekesel, seal omakorda teeme linnukese Drop Shadow ette, valime varju ulatuseks (Offset) 135 kraadi ja 1 mm, udustamise raadiuseks (Blur radius) 2 mm ning Blend mode väärtuseks Normal. Symbology → Labels: muudame teksti suurust väiksemaks (Text → Size → 5 points); joonistame teksti ümber pooleldi läbipaistva puhverala (Buffer → Draw text buffer → Opacity = 50%); muudame siltide paigutuse nurga alla (Placement → General Settings → Mode = Free (Angled)); näitame kõiki (ka kattuvaid) silte (Rendering → Overlapping labels → Mode = Allow Overlaps without Penalty, vanemates QGISi versioonides Rendering → Show all labels for this layer (including colliding labels)). Joonis 7.4: Kihelkonnad vastavalt nende nimede pikkusele Harjutus 4: tekstiavaldised sümbolite kujundamiseks (2) Toome värvi ja/või sümboliga esile ainult need “ei ole”-“pole” andmestiku punktid, mille asustusüksuse nime alguses või lõpus on Jõe-/-jõe või Järve-/-järve. Teised punktid värvime halliks ja teeme läbipaistvamaks. Need punktid, millel asulanime atribuuttabelis ei ole, jätame jooniselt välja. Asendame esmalt ő-sümbolid tulbas ANIMI õ-tähtedega: Selleks saame Field Calculator’is uuendada olemasolevat atribuuti ANIMI (Update existing field) regulaaravaldise abil (String → replace): replace(\"ANIMI\", 'ő', 'õ'). Valime nüüd punktide kihi Symbology alt Categorized ja Value puhul vajutame jälle avaldise sümboliga nuppu. Saame kasutada näiteks operaatorit ILIKE: \"ANIMI\" ILIKE '%jõe%' OR \"ANIMI\" ILIKE '%järve%'. Selles avaldises ütleme, et kujunda mingit moodi ainult need punktid, mille ridadel atribuuttabelis on tulbas “ANIMI” järjend Jõe või jõe (ILIKE on tõstutundetu) sõna alguses, lõpus või keskel (sümbol % märgib ükskõik mis sümboleid ükskõik kui palju, sh ka 0 sümbolit), samamoodi järve kohta. Märgime sellised objektid näiteks tähekestega ja muud punktid, mis avaldisele ei vasta, helehalliks. Lisame sama avaldist kasutades ka sildid ainult valitud punktidele: if(\"ANIMI\" ILIKE '%jõe%' OR \"ANIMI\" ILIKE '%järve%', \"ANIMI\", NULL). Võime lisada alla veel Maa-ameti fotokaartide WMS-teenusest värvilise reljeefvarjutuse (6 vreljeef), et vaadata, kas leitud kohanimed ka päriselt veekogude ääres on. Joonis 7.5: Jõe- ja järvenimelised asulanimed 7.4 Päringud Lisaks eeldefineeritud funktsioonidele saab QGISis kasutada ka SQL-i päringuid, näiteks: Ridade ja tulpade valimine SELECT tulp FROM andmestik; vali andmestikust ainult üks tulp SELECT tulp1, tulp2 FROM andmestik; vali andmestikust kaks tulpa SELECT DISTINCT tulp FROM andmestik; vali andmestikust tulba unikaalsed väärtused SELECT * FROM andmestik; vali andmestikust kõik tulbad ja read SELECT * FROM andmestik WHERE tulp = ‘Mingi väärtus’; vali andmestikust kõik tulbad ja read, kus tulbas ‘tulp’ on väärtus ‘Mingi väärtus’ SELECT tulp1, tulp2 FROM andmestik WHERE tulp1 &gt; 50 AND tulp2 ILIKE ‘%St%’; vali andmestikust tulbad ‘tulp1’ ja ‘tulp2’ ning ainult sellised read, kus tulp1 väärtused on suuremad kui 50 ja kus tulp2s on lahtris kuskil tähejärjend ‘St’ Muutmine UPDATE andmestik SET tulp = ‘Mingi uus väärtus’ WHERE tulp = ‘Mingi vana väärtus’; uuenda andmestikku nii, et sea tulba ‘tulp’ väärtuseks ‘Mingi uus väärtus’ nendel ridadel, kus tulba ‘tulp’ väärtus on praegu ‘Mingi vana väärtus’ UPDATE andmestik SET tulp = ‘Mingi uus väärtus’ WHERE id = 8; uuenda andmestikku nii, et sea tulba ‘tulp’ väärtuseks ‘Mingi uus väärtus’ sellel real, kus id väärtus on 8 Lisamine INSERT INTO andmestik (tulp1, tulp2, tulp3, tulp4) VALUES (‘tulp1 väärtus’, ‘tulp2 väärtus’, ‘tulp3 väärtus’, ‘tulp4 väärtus’); sisesta andmestikku üks rida, kus tulpadesse ‘tulp1’, ‘tulp2’, ‘tulp3’ ja ‘tulp4’ lähevad vastavalt väärtused ‘tulp1 väärtus’, ‘tulp2 väärtus’, ‘tulp3 väärtus’ ja ‘tulp4 väärtus’ Kustutamine DELETE FROM andmestik WHERE tulp = ‘Mingi väärtus’; kustuta andmestikust read, kus tulbas ‘tulp’ on väärtus ‘Mingi väärtus’ Järjestamine SELECT tulp1, tulp2, tulp3 FROM andmestik ORDER BY tulp1; vali andmestikust ainult tulbad ‘tulp1’, ‘tulp2’ ja ‘tulp3’ ning järjesta uus andmestik ‘tulp1’ väärtuste järgi (vaikimisi väiksemast suuremani või A-st Z-ni) SELECT tulp1, tulp2, tulp3 FROM andmestik ORDER BY tulp1, tulp2; vali andmestikust ainult tulbad ‘tulp1’, ‘tulp2’ ja ‘tulp3’ ning järjesta uus andmestik ‘tulp1’ ning siis ‘tulp2’ väärtuste järgi Grupeerimine SELECT tulp1, tulp2 FROM andmestik GROUP BY tulp1; vali andmestikust tulbad ‘tulp1’ ja ‘tulp2’ ning grupeeri andmed ‘tulp1’ unikaalsete väärtuste järgi SELECT tulp1, tulp2 FROM andmestik WHERE tulp1 = ‘Mingi väärtus’ GROUP BY tulp2; vali andmestikust tulbad ‘tulp1’ ja ‘tulp2’ ning ainult read, kus tulbal ‘tulp1’ on väärtused ‘Mingi väärtus’, grupeeri saadud tabel ‘tulp2’ unikaalsete väärtuste järgi 7.5 Harjutus päringutega SQL-i päringuid saab QGISis teha nt DB Manager tööriistaga (ülamenüüs Database → DB Manager). Mõned SQL-i funktsioonid (nt UPDATE) töötavad ainult “päris” andmebaasiformaatidega, nt GeoPackage’i failidega (kui need on ka GeoPackage’ina sisse loetud, mitte lihtsalt vektorfailidena). DB Manageris valime praegu virtuaalsete kihtide alt kihelkondade polügoonide kihi, valime ülevalt menüüst SQL Window ja kirjutame kasti päringu (asendame punktiirid sobivate väärtustega). Valime kihelkondade andmestikust ainult eestikeelse murrete nimede tulba ja salvestame selle eraldi kihil. SELECT ... FROM ...; Kui tahame uuele kihile saada kaasa ka polügoonide andmeid, peame valima “eraldi tulbana” ka kihi geomeetria, mis on enamasti kujul geometry: SELECT ..., geometry FROM ...; Vajutame Execute, teeme linnukese Load as new layer ette ja vajutame Load. Valime kihelkondade andmestikust kõik tulbad, aga ainult need Võru murde kihelkondade read, kus kihelkonna pindala on suurem kui kõikide eesti kihelkondade keskmine pindala. SELECT ... FROM ... WHERE ... = '...' AND ... &gt; (SELECT AVG(...) FROM ...); Leiame murdealade kogupindalad. SELECT ..., SUM(...) AS pindala FROM ... GROUP BY ...; 7.6 Ülesanded 7.6.1 Ülesanne 1: “ei ole”/“pole” suhtelised sagedused murdekorpuses Värvime kihelkondade polügoonid selle põhjal, kui palju neis kasutatakse murdekorpuse (!) andmete põhjal protsentuaalselt eituse varianti ei ole (vs. pole). Need suhtelised sagedused on tabelis eiole_pole_mk_props.csv, aga selle tabeliga ei ole seotud mingeid koordinaate. Peame niisiis ühendama tabeli mingi tunnuse alusel (nt kihelkondade nimede järgi) olemasolevate ruumiandmetega. Teeme esmalt virtuaalse koopia kihelkondade kihist (nimetame selle nt kihelkonnad2). Nõnda ei mõjuta see, mida edasi teeme, meie algandmestikku. Kui muudaksime otse kihelkondade kihti, salvestaksime originaalandmed üle. Koopia tegemiseks on palju viise, ent harjutamise mõttes kasutame selleks siin SQLi päringut. Layer → Create Layer → New Virtual Layer: nimetame kihi nimega kihelkonnad2, Query väljale kirjutame SELECT * FROM kihelkonnad ja vajutame Add; Ühendame andmestiku eiole_pole_mk_props kihiga kihelkonnad2. Esmalt kontrollime, kas ühendamine võiks üldse korralikult õnnestuda, st kas mõlemas kihis viidatakse samadele kihelkondadele ühtmoodi. Selleks, et leida kihelkonnad/murrakud, mis on kahele kihile ühised, saab kasutada SQLi päringut SELECT Murrak FROM eiole_pole_mk_props INTERSECT SELECT Parish_id FROM kihelkonnad2;. Selleks, et leida aga kihelkonnad, mida teises andmestikus ei ole, võib kasutada päringut SELECT Murrak FROM eiole_pole_mk_props EXCEPT SELECT Parish_id FROM kihelkonnad2;. Kasutame päringu tegemiseks DB Manageri. Kui oleme vajutanud nupul Execute, väljastatakse alumisse aknasse need murrakute nimed, mis on küll andmestikus eiole_pole_mk_props tulbas Murrak, ent mida ei ole sellisel kujul andmestikus kihelkonnad2 tulbas Parish_id. Joonis 7.6: Vigase kihelkonnanime tuvastamine Parandame CSV-kihis selle murraku nime, mis ei sisaldu kihelkondade shapefile’is. Kuna CSV-faili atribuute muuta ei saa, lisame kihile uue virtuaalse atribuudi Murrak2, kus asendame vigase nime õigega (kasutame if-tingimuslauset). Joonis 7.7: Uue virtuaalse atribuudi loomine Lisame kihile kihelkonnad2 ei ole/pole kasutamise sagedusandmed. Kasutame andmestike ühendamiseks vastavalt Parish_id ja Murrak2 tulpasid. Teine moodus kihte ühe tunnuse alusel ühendada on nii, kui valime Processing → Toolbox → Vector general → Join attributes by field value. Erinevus tavalise Join-funktsiooniga on selles, et tekib uus kiht (vaikimisi nimega Joined layer). Värvime ei ole/pole proportsioonide infoga täiendatud kihi kihelkonnad2 polügoonid vastavalt ei ole suhtelisele sagedusele kihelkonnas/murrakus nii, et viirutatult oleksid märgitud ka kihelkonnad, millest murdekorpuse sagedusinfot ei ole (vaikimisi klassifitseerides neid kihelkondi enam üldse ei näidataks). Selleks peab kasutama reeglipõhist sümboloogiat. Nendele kihelkondadele, kust infot on, teeme 5 sagedusklassi (0-0.2, 0.2-0.4, 0.4-0.6, 0.6-0.8 ja 0.8-1.0). Joonis 7.8: Reeglipõhine polügoonide värvimine 7.6.2 Ülesanne 2: “ei ole”/“pole” murdeatlase levikuandmed Lisame joonisele ka murdeatlase punktandmed ning eristame punktide välimuse selle järgi, kas tegemist on ei ole või pole variandiga. Kuna praegu on keelendi tulbas igasuguseid variante, nt põle, ei (äi) ole, ole ei (õi), ei (äi, öi) pole, siis peaks esmalt looma ühe binaarse (ainult kahe võimaliku väärtusega) atribuudi, kus oleksid ainult väärtused ei ole ja pole. Selleks filtreerime (paremklikk → Filter) kihist 30_ei_ole välja ainult need read, kus keelendi info on olemas (\"Keelend\" IS NOT NULL) ning lisame selle atribuuttabelisse Field Calculator’i abil uue virtuaalse atribuudi/tulba nimega Keelend2, kuhu paneme väärtuse pole siis, kui keelendi tulbas esineb p-täht, ja ei ole siis, kui ei esine (see tähendab, et ka nt ei pole klassifitseeritakse pole-ks). Kasutame if-tingimuslauset ja ILIKE-operaatorit: if(\"Keelend\" ILIKE '%p%', 'pole', 'ei ole'). Joonis 7.9: Binaarse virtuaalse tunnuse loomine Valime binaarsele keelendile vastava sümboli ja värvi. Joonis 7.10: Korpuse ja atlase andmed eituskonstruktsioonide ei ole ja pole sagedusest ja levikust 7.6.3 Ülesanne 3: “ei ole”/“pole” selged eelistused Teeme kihist kihelkonnad2 duplikaadi nimega kihelkonnad3 (paremklikk → Duplicate Layer ja uuel kihil paremklikk → Rename Layer). Kasutades reeglipõhist polügoonide värvimist, kuvame kihil kihelkonnad3 värviliselt ainult kihelkonnad, mille puhul ei ole ja pole proportsioonide absoluuterinevus on vähemalt 0,5. Ülejäänud polügoonidele (sh puuduvatele väärtustele) määrame halli värvi. Joonis 7.11: Suured sageduserinevused Nüüd muudame reegleid nii, et kihelkonnad, mille puhul ei_ole ja pole suur vahe on negatiivne (-0,5 või vähem), on punased, ja need, mille vahe on positiivne (0,5 või suurem), on sinised. Joonis 7.12: ei ole ja pole konstruktsioonide eelistused murrakutes 7.6.4 Ülesanne 4: tekstiatribuutide muutmine Muudame kihil kihelkonnad3 eestikeelsete murrete nimetustes kõik Setu murded Seto murreteks, kasutades if-tingimuslauset. Salvestame uued nimed uude tulpa Murre. Joonis 7.13: Setu murre Seto murdeks Muudame nüüd kihil kihelkonnad3 ingliskeelsete murrete nimetustes kõik Setu murded Seto murreteks, kasutades CASE-tingimuslauset. Salvestame uued nimed uude tulpa Dialect. Joonis 7.14: Setu murre Seto murdeks (2) Leiame kihil kihelkonnad3 kõik kihelkondade nimed, mille saksakeelne nimi algab lühendiga St. ning muudame lühendi Sankt’iks, kasutades regulaaravaldist. Salvestame uued nimed uude tulpa nimega Saksakeelne_nimi. Joonis 7.15: St. muutmine Sankt’iks Leiame kõik kihelkonnad, mille nimed lõppevad la-ga (nt Ambla) ja asendame need lõpud uues tulbas nimega “Kihelkond” LA-ga (AmbLA), kasutades regulaaravaldist: regexp_replace(\"Name\", '(.*)la', '\\\\1LA'). Siin ütleme, et tulba Name kõikides sõnades, mis algavad mis iganes sümboliga (nt tähega, numbriga, kirjavahemärgiga, tühikuga) ., mida esineb ükskõik mitu korda * (nt Kei, Viga, Amb, Halja) ja kus sellele millele iganes mitu iganes korda järgneb järjend la, jäta alles see esimene \\\\1 (ja siin ainus) grupeeritud osa (.*) enne la-d, aga grupeeritud osa lõpus asenda järjend la järjendiga LA. Põhimõtteliselt võiksime kasutada DB Manageris ka UPDATE CASE WHERE lauseid, ent kuna ükski meie kihtidest ei ole QGISi jaoks päris andmebaas, siis saame teha DB Manageris ainult päringuid, aga tabelit muuta ei saa. Saame aga eksportida mõne virtuaalse kihi näiteks GeoPackage-formaadis failina ning seda uuesti sisse lugedes saame andmestikku DB Manageris ka SQL-lausete abil muuta. "],["kirjandus.html", "Kirjandus", " Kirjandus "]]
